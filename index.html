<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Curadoria Elite Travel - O seu mundo, perfeitamente indicado</title>

  <!-- FONTS & ICONS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" crossorigin="anonymous"/>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet" />

  <!--
    INSTRUÇÕES IMPORTANTES (LEIA ANTES DE SUBIR):
    1) Supabase:
       - Defina SUPABASE_URL e SUPABASE_ANON_KEY nas variáveis abaixo (LOCAL ou no host).
       - O projeto Supabase deve incluir as tabelas: users, purchases, products, reviews, messages.
       - Recomendo ativar Row Level Security (RLS) e políticas adequadas.
    2) Stripe:
       - Para checkout automático sem intervenção, crie Payment Links (ou Sessions) no Stripe Dashboard.
       - No administrador você pode colar a URL do Payment Link em "Arquivo/Pagamento" do produto.
       - Para confirmação automática de compra, implemente um webhook server-side (ver comentários em processPaymentConfirm).
    3) Email (contatos/avaliações):
       - Recomendo usar um endpoint serverless (SendGrid / Sendinblue / email provider) para enviar e-mails e não expor chaves no front-end.
       - No front-end o contato chama /api/send-contact (endpoint serverless) (ex.: Vercel Functions).
    4) PCI & armazenamento de cartões:
       - NÃO armazene números de cartão no seu front-end ou Supabase. Use Stripe (Checkout/Payment Links) para cumprir PCI.
       - O perfil guarda apenas referência (últimos 4 dígitos) e status de pagamento.
  -->

  <style>
    /* ==================== VARIÁVEIS ==================== */
    :root{
      --gold:#D4AF37;
      --bg-dark:#121212;
      --card-dark:#1e1e1e;
      --text-light:#f1f1f1;
      --border-dark:#333333;
      --btn-hover:#E1C16E;
    }
    .light-theme{
      --bg-dark:#ffffff;
      --card-dark:#f9f9f9;
      --text-light:#222222;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:'Playfair Display',serif;background:var(--bg-dark);color:var(--text-light);line-height:1.6;transition:background .3s,color .3s}
    .container{width:92%;max-width:1200px;margin:0 auto}
    header{background:var(--card-dark);border-bottom:1px solid var(--border-dark);position:sticky;top:0;z-index:200}
    .header-content{display:flex;align-items:center;justify-content:space-between;padding:12px 0}
    .brand{display:flex;align-items:center;gap:12px}
    .brand img{width:44px;height:44px;object-fit:contain}
    .brand h1{font-family:'Cinzel',serif;font-size:1.05rem;color:var(--text-light);margin:0}
    .brand small{display:block;color:var(--gold);font-size:0.78rem}
    nav ul{list-style:none;display:flex;gap:18px;align-items:center}
    nav a{color:var(--text-light);text-transform:uppercase;font-weight:700;font-size:0.82rem;text-decoration:none}
    .auth-buttons{display:flex;gap:10px;align-items:center}
    .btn{padding:8px 14px;border-radius:6px;border:2px solid var(--gold);background:var(--gold);color:#111;font-weight:700;cursor:pointer;font-family:'Cinzel',serif}
    .btn-outline{background:transparent;border:2px solid var(--gold);color:var(--gold)}
    .btn-small{padding:6px 10px;font-size:0.82rem}
    /* HERO */
    #hero{background-image:url('https://picsum.photos/1600/700?blur=2');background-size:cover;background-position:center;height:62vh;display:flex;align-items:center;justify-content:center;text-align:center;position:relative}
    #hero::before{content:"";position:absolute;inset:0;background:rgba(0,0,0,0.45)}
    .hero-content{position:relative;z-index:2;color:var(--text-light);max-width:900px;padding:36px}
    .hero-content h2{font-family:'Cinzel',serif;color:var(--gold);font-size:2.6rem;margin-bottom:10px}
    .hero-content p{font-size:1.02rem;color:var(--text-light);margin-bottom:12px}
    .social-icons{display:flex;gap:16px;justify-content:center;margin-bottom:14px}
    .social-icons a{font-size:1.6rem;color:var(--text-light)}
    .social-icons a:hover{color:var(--gold)}
    section{padding:56px 0}
    h2.section-title{text-align:center;color:var(--gold);font-family:'Cinzel',serif;margin-bottom:14px}
    /* WHO / QUEM SOMOS */
    .who .who-text{max-width:920px;margin:0 auto;text-align:center;color:var(--text-light);font-size:1rem}
    .about-cards{display:grid;grid-template-columns:repeat(3,1fr);gap:20px;max-width:1100px;margin:24px auto 0}
    .about-card{background:var(--card-dark);padding:22px;border-radius:8px;border:1px solid var(--border-dark);box-shadow:0 6px 14px rgba(0,0,0,0.45);cursor:pointer;transition:transform .18s}
    .about-card h4{color:var(--gold);margin-bottom:8px}
    .about-card p{color:var(--text-light);opacity:0.9}
    .about-card:hover{transform:translateY(-6px);border-color:var(--gold)}
    /* GRID / CATEGORIES */
    .categories-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:14px;margin-top:18px}
    .category-card{background:var(--card-dark);padding:14px;border-radius:8px;border:1px solid var(--border-dark);display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:120px;cursor:pointer}
    .category-card.disabled{opacity:.55;cursor:not-allowed}
    .product-card{background:var(--card-dark);padding:18px;border-radius:8px;border:1px solid var(--border-dark);text-align:center}
    .product-price{font-size:1.2rem;color:var(--gold);font-weight:700;margin:12px 0}
    /* RATING / CONTACT / REVIEW */
    .rating-section{max-width:820px;margin:0 auto;text-align:center;padding:18px;border:1px solid var(--border-dark);border-radius:8px}
    .stars .fa-star{font-size:26px;color:var(--text-light);margin:0 6px;cursor:pointer}
    .stars .selected{color:#FFC107}
    /* FOOTER (reduced) */
    footer.site-footer{background:var(--card-dark);color:var(--text-light);padding:14px 0;border-top:2px solid var(--gold)}
    .footer-content{display:flex;justify-content:space-between;gap:16px;align-items:flex-start;flex-wrap:wrap;max-width:1200px;margin:0 auto;padding:0 16px}
    .footer-left{flex:1 1 45%}
    .footer-right{flex:1 1 45%;text-align:right}
    .footer-bottom{text-align:center;padding-top:12px;border-top:1px solid var(--border-dark);color:var(--text-light);font-size:0.85rem}
    .theme-toggle-footer{background:none;border:none;font-size:26px;color:var(--gold);cursor:pointer;display:block;margin:0 auto}
    /* slide menu (mobile full menu) */
    .slide-menu{position:fixed;top:0;left:-320px;bottom:0;width:320px;background:var(--card-dark);z-index:600;transition:left .28s;box-shadow:6px 0 22px rgba(0,0,0,0.6);padding:18px}
    .slide-menu.open{left:0}
    .slide-menu .close-slide{position:absolute;right:12px;top:12px;color:var(--text-light);font-size:20px;cursor:pointer}
    .slide-menu .menu-list{margin-top:40px;display:flex;flex-direction:column;gap:12px}
    .slide-menu a{color:var(--text-light);text-decoration:none;padding:10px;border-radius:6px;font-weight:700}
    /* bottom nav minimal */
    .bottom-nav{display:none;position:fixed;left:0;right:0;bottom:0;background:var(--card-dark);border-top:1px solid var(--border-dark);display:flex;justify-content:space-around;align-items:center;padding:8px 6px;z-index:300}
    .bottom-nav a{color:var(--text-light);text-decoration:none;font-size:0.85rem;display:flex;flex-direction:column;align-items:center;gap:6px}
    .bottom-nav .icon{font-size:18px;color:var(--gold)}
    @media (max-width:768px){
      nav ul{display:none}
      .about-cards{grid-template-columns:1fr}
      .bottom-nav{display:flex}
      body{padding-bottom:68px}
      .footer-right{text-align:center}
      .footer-content{flex-direction:column;align-items:center;text-align:center}
    }
    .modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.7);backdrop-filter:blur(3px);z-index:800;align-items:center;justify-content:center}
    .modal.active{display:flex}
    .modal-box{background:var(--card-dark);padding:22px;border-radius:8px;border:1px solid var(--gold);width:92%;max-width:560px;position:relative}
    .close-x{position:absolute;right:12px;top:8px;font-size:22px;color:var(--text-light);cursor:pointer}
    input, textarea, select{width:100%;padding:10px;border-radius:6px;border:1px solid var(--border-dark);background:transparent;color:var(--text-light);margin-bottom:10px}
    .feedback{padding:10px;border-radius:6px;margin-top:10px}
    .feedback.success{background:rgba(76,175,80,0.12);color:#4CAF50}
    .feedback.error{background:rgba(244,67,54,0.08);color:#F44336}
  </style>
</head>
<body>

  <!-- HEADER -->
  <header>
    <div class="container">
      <div class="header-content">
        <div class="brand">
          <!-- Rosa dos Ventos ao lado do nome (arquivo em assets/compass.png sugerido) -->
          <img src="https://cdn.jsdelivr.net/gh/curadoriaelitetravel-cmd/Curadoria-Elite-Travel@main/assets/compass.png" alt="Rosa dos Ventos">
          <div>
            <h1>CURADORIA ELITE TRAVEL</h1>
            <small>O seu mundo, perfeitamente indicado.</small>
          </div>
        </div>

        <nav>
          <ul>
            <li><a href="#hero" onclick="showSection('hero')">Início</a></li>
            <li><a href="#about-us" onclick="showSection('about-us')">Quem Somos</a></li>
            <li><a href="#categories" onclick="showSection('categories')">Curadoria</a></li>
            <li><a href="#daily-columns" onclick="showSection('daily-columns')">Colunas</a></li>
            <li><a href="#review-form" onclick="showSection('review-form')">Avalie-nos</a></li>
            <li><a href="#contact-form" onclick="showSection('contact-form')">Contato</a></li>
          </ul>
        </nav>

        <div class="auth-buttons" id="auth-buttons">
          <button class="btn btn-small btn-admin" onclick="openAdminLoginModal()">Admin</button>
          <div id="auth-state">
            <button class="btn btn-small btn-outline" onclick="openAuthModal('login')">Entrar / Cadastrar</button>
          </div>
          <div class="user-info" id="user-display" style="display:none">
            <div class="user-avatar" id="user-initial" style="background:var(--gold);color:#111;padding:8px 10px;border-radius:50%;font-weight:700;cursor:pointer"></div>
            <span id="user-welcome" style="color:var(--text-light);margin-left:6px"></span>
            <button class="btn-small" style="background:transparent;border:none;color:var(--gold);cursor:pointer;margin-left:8px" onclick="logoutUser()">Sair</button>
          </div>
          <!-- mobile menu toggle -->
          <button class="btn btn-small" onclick="openSlideMenu()" title="Abrir menu">☰</button>
        </div>
      </div>
    </div>
  </header>

  <!-- SLIDE MENU (mobile full menu) -->
  <div id="slideMenu" class="slide-menu" aria-hidden="true">
    <span class="close-slide" onclick="closeSlideMenu()">&times;</span>
    <div class="menu-list">
      <a href="#hero" onclick="navigateFromMenu('hero')">Início</a>
      <a href="#about-us" onclick="navigateFromMenu('about-us')">Quem Somos</a>
      <a href="#categories" onclick="navigateFromMenu('categories')">Curadoria</a>
      <a href="#daily-columns" onclick="navigateFromMenu('daily-columns')">Colunas</a>
      <a href="#review-form" onclick="navigateFromMenu('review-form')">Avalie-nos</a>
      <a href="#contact-form" onclick="navigateFromMenu('contact-form')">Contato</a>
    </div>
    <div style="position:absolute;bottom:18px;left:18px;right:18px;text-align:center">
      <button class="btn btn-outline btn-small" onclick="toggleTheme()">Alternar Tema</button>
    </div>
  </div>

  <!-- HERO -->
  <section id="hero" class="active">
    <div class="hero-content container">
      <h2>Curadoria Elite Travel</h2>
      <p class="lead">Orquestramos cada detalhe com cuidado e expertise — você vive as experiências.</p>
      <p>Curadoria exclusiva para as experiências de viagem mais inesquecíveis.</p>

      <div class="social-icons">
        <a id="ig-link" href="https://www.instagram.com/curadoriaelitetravel/" target="_blank" rel="noopener noreferrer" title="Instagram"><i class="fab fa-instagram"></i></a>
        <a id="li-link" href="https://www.linkedin.com/company/curadoria-elite-travel" target="_blank" rel="noopener noreferrer" title="LinkedIn"><i class="fab fa-linkedin"></i></a>
      </div>

      <button class="btn btn-primary btn-curadoria" onclick="showSection('categories')">Descubra nossas Curadorias</button>
    </div>
  </section>

  <!-- QUEM SOMOS -->
  <section id="about-us">
    <div class="container who">
      <h2 class="section-title">Quem Somos</h2>
      <p class="who-text" style="margin-top:10px">
        Na Curadoria Elite Travel, acreditamos que seu tempo é seu bem mais valioso. Percebemos que, em um mundo onde a praticidade digital é essencial, o viajante moderno buscava autonomia sem abrir mão de inspiração e confiança – uma assistência ágil e personalizada que ainda não existia. Foi dessa necessidade que nascemos: somos a resposta para quem deseja explorar o mundo de forma inteligente, com curadorias que transformam destinos em universos referenciados e acessíveis digitalmente. Abraçamos essa missão com excelência, oferecendo narrativas turísticas sob medida para que sua próxima aventura seja não apenas planejada, mas vivida intensamente, mesmo antes de partir. O seu mundo, bem indicado.
      </p>

      <div class="about-cards" style="margin-top:22px">
        <div class="about-card" data-popup-title="VISÃO" data-popup-content="Ser a principal referência digital para quem busca apoio, inspiração e orientação em viagens, oferecendo uma curadoria de alto nível que torna a descoberta de destinos mais clara, elegante e acessível — um ponto de partida confiável para explorar o mundo com profundidade e propósito.">
          <h4>VISÃO</h4>
          <p>Ser referência digital em curadoria de viagens.</p>
        </div>

        <div class="about-card" data-popup-title="MISSÃO" data-popup-content="Oferecer materiais de apoio que iluminam a escolha dos melhores lugares, reunindo conteúdo de qualidade, excelência na seleção e uma visão equilibrada entre experiência e valor.">
          <h4>MISSÃO</h4>
          <p>Oferecer materiais de apoio que iluminam as escolhas.</p>
        </div>

        <div class="about-card" data-popup-title="NICHO" data-popup-content="Viajantes que buscam experiências entre 3 e 4 estrelas, desejando conhecer os principais destinos de forma acolhedora, inteligente e cuidadosamente selecionada.">
          <h4>NICHO</h4>
          <p>Foco em viajantes 3–4 estrelas.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- CATEGORIES & PRODUCTS -->
  <section id="categories">
    <div class="container">
      <h2 class="section-title">Categorias de Curadoria</h2>
      <p style="text-align:center;color:var(--text-light);opacity:0.9;margin-top:8px">Navegue pelos temas que definem sua próxima aventura.</p>

      <div class="categories-grid" id="category-cards-container"></div>

      <div id="products" style="margin-top:22px;display:none">
        <h3 id="current-category-title" class="center muted"></h3>
        <div class="products-container" id="products-container"></div>
      </div>
    </div>
  </section>

  <!-- COLUMNS -->
  <section id="daily-columns">
    <div class="container">
      <h2 class="section-title">Colunas Diárias</h2>
      <p style="text-align:center;color:var(--text-light);opacity:0.9;margin-top:8px">Dicas, inspirações e tendências do mundo das viagens.</p>

      <div class="columns-container" id="columns-container" style="margin-top:18px;display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:18px"></div>
    </div>
  </section>

  <!-- REVIEW -->
  <section id="review-form">
    <div class="container">
      <h2 class="section-title">Sua percepção nos ajuda a evoluir</h2>
      <p style="text-align:center;color:var(--text-light);opacity:0.9;margin-top:8px">Ajude-nos a manter o nível de excelência. Deixe sua avaliação.</p>

      <div class="rating-section" style="margin-top:18px">
        <div class="stars" id="rating-stars" style="margin-bottom:8px"></div>
        <div id="rating-legend" class="muted" style="margin-bottom:10px"></div>

        <form id="submit-review-form" style="max-width:900px;margin:10px auto" onsubmit="submitReview(event)">
          <div style="display:flex;gap:10px;flex-wrap:wrap;margin-bottom:10px">
            <input id="review-nome" placeholder="Nome" required style="flex:1" />
            <input id="review-sobrenome" placeholder="Sobrenome" required style="flex:1" />
          </div>

          <div style="display:flex;gap:10px;flex-wrap:wrap;margin-bottom:10px">
            <input id="review-email" type="email" placeholder="Email" required style="flex:1" />
            <input id="review-genero" placeholder="Gênero" style="flex:1" />
          </div>

          <div style="display:flex;gap:10px;flex-wrap:wrap;margin-bottom:10px">
            <input id="review-aniversario" type="date" required style="flex:1" />
            <input id="review-estado" placeholder="Estado" required style="flex:1" />
            <input id="review-cidade" placeholder="Cidade" required style="flex:1" />
          </div>

          <div style="margin-bottom:10px">
            <select id="review-tipo" required>
              <option value="">Tipo de Feedback</option>
              <option value="Comentário">Comentário</option>
              <option value="Sugestão">Sugestão</option>
            </select>
          </div>

          <textarea id="review-comentario" rows="4" maxlength="200" placeholder="Comentário / Sugestão (máx. 200 caracteres)" required></textarea>

          <div id="review-feedback" class="feedback" style="display:none"></div>
          <button type="submit" class="btn btn-primary">Enviar Avaliação</button>
        </form>
      </div>
    </div>
  </section>

  <!-- CONTACT -->
  <section id="contact-form">
    <div class="container" style="max-width:720px">
      <h2 style="text-align:center">Fale Conosco</h2>
      <p style="text-align:center;color:var(--text-light);opacity:0.9;margin-bottom:14px">Envie-nos uma mensagem, ficaremos felizes em ajudar!</p>

      <div class="modal-box card" style="padding:18px">
        <form id="contactForm" onsubmit="sendContactEmail(event)">
          <input id="contact-name" name="from_name" placeholder="Nome" required />
          <input id="contact-email" name="from_email" type="email" placeholder="Email" required />
          <input id="contact-subject" name="subject" placeholder="Assunto" required />
          <textarea id="contact-message" name="message" rows="5" maxlength="300" placeholder="Mensagem (máx. 300 caracteres)" required></textarea>

          <div id="contact-feedback" class="feedback" style="display:none"></div>
          <button type="submit" class="btn btn-primary">Enviar Mensagem</button>
        </form>
      </div>
    </div>
  </section>

  <!-- USER PROFILE (hidden until login) -->
  <section id="user-profile" style="display:none">
    <div class="container">
      <div class="profile-container" id="profile-content" style="background:var(--card-dark);padding:18px;border-radius:8px">
        <h2>Perfil do Cliente</h2>

        <div class="profile-section" style="margin-top:12px">
          <h3>Informações Pessoais</h3>
          <div id="personal-data-view" class="profile-data-grid" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:12px"></div>
          <div id="personal-data-edit" style="display:none;margin-top:10px"></div>
        </div>

        <div class="profile-section" style="margin-top:16px">
          <h3>Materiais Adquiridos</h3>
          <ul id="purchased-materials" style="list-style:none;padding:0;margin-top:10px">
            <li>Nenhum material adquirido ainda.</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- ADMIN (panel minimal local) -->
  <section id="admin" style="display:none">
    <div class="container">
      <div id="admin-panel" style="background:var(--card-dark);padding:18px;border-radius:8px;border:1px solid var(--border-dark)">
        <h2>Painel Administrativo</h2>

        <div style="margin-top:14px;display:flex;gap:12px;flex-wrap:wrap">
          <button class="btn btn-outline" onclick="showAdminSection('category')">Categorias</button>
          <button class="btn btn-outline" onclick="showAdminSection('product')">Produtos (PDF / Payment Link)</button>
          <button class="btn btn-outline" onclick="showAdminSection('columns')">Colunas</button>
          <button class="btn btn-outline" onclick="showAdminSection('export')">Exportar (Excel)</button>
          <button class="btn" onclick="adminLogout()">Sair</button>
        </div>

        <div id="admin-forms" style="margin-top:18px"></div>
      </div>
    </div>
  </section>

  <!-- FOOTER (reduced height + theme toggle centered) -->
  <footer class="site-footer" aria-label="Rodapé">
    <div class="footer-content">
      <div class="footer-left">
        <h3 style="color:var(--gold);margin-bottom:6px">Curadoria Elite Travel</h3>
        <p style="margin:0;color:var(--text-light);opacity:0.9">O seu mundo, perfeitamente indicado. Curadorias e materiais digitais para sua próxima viagem.</p>
      </div>

      <div class="footer-right">
        <div style="display:flex;gap:14px;align-items:center;justify-content:center">
          <div style="text-align:right">
            <div style="font-weight:700;color:var(--text-light)">curadoriaelitetravel@gmail.com</div>
            <div style="color:var(--text-light);opacity:0.85">São Paulo, SP</div>
          </div>
          <button class="theme-toggle-footer" id="theme-toggle-footer" title="Alternar tema" onclick="toggleTheme()"><i id="theme-icon-footer" class="fas fa-moon"></i></button>
        </div>
      </div>
    </div>

    <div class="container footer-bottom" style="margin-top:12px">
      <p style="margin:6px 0">© 2025 Curadoria Elite Travel. Todos os direitos reservados.</p>
    </div>
  </footer>

  <!-- MODALS (Quem somos popups e column modal & checkout modal placeholder) -->
  <div id="about-popup" class="modal" aria-hidden="true">
    <div class="modal-box">
      <span class="close-x" onclick="closeModal('about-popup')">&times;</span>
      <h3 id="about-popup-title" style="margin-bottom:8px;color:var(--gold)"></h3>
      <p id="about-popup-content" style="color:var(--text-light)"></p>
    </div>
  </div>

  <div id="column-modal" class="modal">
    <div class="modal-box">
      <span class="close-x" onclick="closeModal('column-modal')">&times;</span>
      <h3 id="modal-column-title" style="color:var(--gold)"></h3>
      <p id="modal-column-date" style="color:var(--text-light);opacity:0.85"></p>
      <div id="modal-column-content" style="margin-top:10px;color:var(--text-light)"></div>
    </div>
  </div>

  <div id="checkout-modal" class="modal">
    <div class="modal-box">
      <span class="close-x" onclick="closeModal('checkout-modal')">&times;</span>
      <h3 style="color:var(--gold)">Finalizar Compra</h3>
      <p id="checkout-product-name" style="color:var(--text-light);margin-top:8px"></p>
      <p id="checkout-product-price" style="color:var(--gold);font-weight:700;margin-top:6px"></p>
      <p style="margin-top:12px;color:var(--text-light)">Você será redirecionado ao pagamento seguro (Stripe). Após confirmação, o material aparecerá em seu perfil.</p>
      <div style="margin-top:12px;text-align:center">
        <button class="btn btn-primary" id="open-payment-link-btn">Ir para Pagamento</button>
        <div style="margin-top:10px">
          <small style="color:var(--text-light);opacity:0.85">Se você já finalizou o pagamento, clique em "Confirmar Recebimento" para salvar a compra (atenção: fluxo ideal usa webhook server-side para confirmação automática).</small>
        </div>
        <div style="margin-top:8px">
          <button class="btn btn-outline" onclick="confirmManualPurchase()">Confirmar Recebimento</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Admin login modal (simple) -->
  <div id="admin-login-modal" class="modal">
    <div class="modal-box">
      <span class="close-x" onclick="closeModal('admin-login-modal')">&times;</span>
      <h3 style="color:var(--gold)">Acesso Administrativo</h3>
      <div style="margin-top:10px">
        <input id="admin-email" placeholder="Email do Admin" />
        <input id="admin-password" type="password" placeholder="Senha" />
        <div id="admin-login-feedback" style="display:none" class="feedback"></div>
        <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:8px">
          <button class="btn btn-primary" onclick="adminLogin()">Entrar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- SCRIPTS -->
  <script type="module">
    /******************************************************
     *  CONFIGURAÇÕES (INCLUA SUAS CHAVES AQUI / ou em ENV)
     ******************************************************/
    // Supabase (coloque os valores reais ou mantenha as variáveis para uso no host)
    const SUPABASE_URL = 'https://lnyoqoezezisakghtmim.supabase.co'; // substitua se diferente
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxueW9xb2V6ZXppc2FrZ2h0bWltIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQxNjI4OTMsImV4cCI6MjA3OTczODg5M30.Nn9ZPRXeJlvCGJ2kXQ3XBvT743pQn2VIXEsT9pexqnA'; // se desejar usar Supabase aqui
    // Stripe (public): insira sua chave publicável (apenas pk_**)
    const STRIPE_PUBLISHABLE_KEY = 'pk_live_51SXReiHvEqwCsLqfqbPpxkqLxBV2Q248gjWDCXL2ehexlB7L4gLfxB2r4RFQNMmuWWKVF9tfWsGyusRN5y43qYnH00ZDHQcO2E';

    // Endpoint serverless para envios de e-mail (recomendo /api/send-contact)
    const SEND_CONTACT_ENDPOINT = '/api/send-contact'; // implementar serverless para usar SendGrid / provider

    // ********************************************************************
    // NOTA IMPORTANTE:
    // - NÃO coloque a SECRET_KEY do Stripe no front-end (somente a publishable key).
    // - Para confirmação automática de compra (webhook) você precisa de um servidor.
    // ********************************************************************

    // Import Supabase client (esm)
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';
    const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    /*******************
     * MOCK inicial (se desejar substituir por DB, o admin pode inserir)
     *******************/
    let MOCK_CATEGORIES = [
      { id: 1, name: "City Guide", icon: "map", price: 49.90, status: 'enabled', description: 'Roteiros completos de cidade.' },
      { id: 2, name: "Restaurante", icon: "restaurant", price: 29.90, status: 'enabled', description: 'Seleção dos melhores lugares para comer.' },
      { id: 9, name: "Hoteis", icon: "hotel", price: 59.90, status: 'enabled', description: 'Seleção de hospedagens de luxo.' }
    ];

    let MOCK_PRODUCTS = [
      { id: 101, code: 'CG-PAR-24', categoryId: 1, country: 'França', city: 'Paris', price: 49.90, description: 'Guia de Paris 3 dias.', fileUrl: '/assets/mock_pdf_paris.pdf', paymentLink: '' },
      { id: 102, code: 'RT-NY-24', categoryId: 2, country: 'EUA', city: 'Nova York', price: 29.90, description: 'Roteiro Gastronômico', fileUrl: '/assets/mock_pdf_ny_rest.pdf', paymentLink: '' }
    ];

    let MOCK_COLUMNS = [
      { id: 1, title: "O Despertar de Lisboa: Um Guia Pessoal", date: "15/11/2025", content: "Lisboa, a cidade das sete colinas..." },
      { id: 2, title: "Gastronomia de Milão: Além da Moda", date: "10/11/2025", content: "Milão é a capital..." }
    ];

    let MOCK_USERS = [
      {
        id: '1',
        profileName: 'AdminCliente',
        email: 'cliente@elitetravel.com',
        password: 'cliente@123',
        firstName: 'Cliente',
        lastName: 'Teste',
        birthDate: '1990-01-01',
        state: 'São Paulo',
        city: 'São Paulo',
        purchases: [
          { productId: 101, code: 'CG-PAR-24', title: 'Guia de Paris 3 dias', date: '2025-10-20', fileUrl: '/assets/mock_pdf_paris.pdf' }
        ]
      }
    ];

    let MOCK_REVIEWS = [];
    let MOCK_MESSAGES = [];
    let MOCK_STATS = {
      views: 1245,
      downloads: 42,
      sales: 42 * 49.90,
      reviews: 0,
      messages: 0,
      profiles: MOCK_USERS.length
    };

    let CURRENT_USER = null;
    let selectedRating = 0;

    /*******************
     * Inicialização
     *******************/
    document.addEventListener('DOMContentLoaded', () => {
      // Aplica tema salvo
      if (localStorage.getItem('theme') === 'light') {
        document.body.classList.add('light-theme');
        document.getElementById('theme-icon-footer').className = 'fas fa-sun';
      }

      renderCategoryCards();
      renderColumns();
      renderRatingStars();
      updateAuthDisplay();
      bindAboutCards();
      bindSlideMenu();
      renderAdminForms();
    });

    /*******************
     * SPA & UI helpers
     *******************/
    function showSection(sectionId) {
      document.querySelectorAll('section').forEach(section => section.style.display = 'none');
      const target = document.getElementById(sectionId);
      if (target) target.style.display = 'block';
      window.scrollTo({ top: 0, behavior: 'smooth' });
      // if user-profile show profile details
      if (sectionId === 'user-profile') renderUserProfile();
    }
    window.showSection = showSection;

    function toggleTheme() {
      const body = document.body;
      body.classList.toggle('light-theme');
      const isLight = body.classList.contains('light-theme');
      const icon = document.getElementById('theme-icon-footer');
      icon.className = isLight ? 'fas fa-sun' : 'fas fa-moon';
      localStorage.setItem('theme', isLight ? 'light' : 'dark');
    }
    window.toggleTheme = toggleTheme;

    function openSlideMenu() { document.getElementById('slideMenu').classList.add('open'); }
    function closeSlideMenu() { document.getElementById('slideMenu').classList.remove('open'); }
    function navigateFromMenu(id) { closeSlideMenu(); showSection(id); }
    function bindSlideMenu() {
      // attach nav links in slide menu
      document.querySelectorAll('#slideMenu a').forEach(a => {
        a.addEventListener('click', (e) => {
          e.preventDefault();
          const href = a.getAttribute('href') || a.dataset.href || a.textContent.toLowerCase();
        });
      });
    }
    window.openSlideMenu = openSlideMenu;
    window.closeSlideMenu = closeSlideMenu;
    window.navigateFromMenu = navigateFromMenu;

    /*******************
     * ABOUT cards popup
     *******************/
    function bindAboutCards() {
      document.querySelectorAll('.about-card').forEach(card => {
        card.addEventListener('click', () => {
          const title = card.dataset.popupTitle;
          const content = card.dataset.popupContent;
          openAboutPopup(title, content);
        });
      });
    }
    function openAboutPopup(title, content) {
      document.getElementById('about-popup-title').textContent = title;
      document.getElementById('about-popup-content').textContent = content;
      document.getElementById('about-popup').classList.add('active');
    }
    function closeModal(id) { document.getElementById(id).classList.remove('active'); }
    window.closeModal = closeModal;

    // Close any modal when clicking outside
    window.addEventListener('click', (e) => {
      document.querySelectorAll('.modal').forEach(m => {
        if (e.target === m) m.classList.remove('active');
      });
    });

    /*******************
     * AUTH (simple mock + Supabase hooks)
     *******************/
    async function registerUser(event) {
      // Not used in current UI (we use modal prompts). Can be wired to forms.
    }

    function openAuthModal(tab = 'login') {
      // For simplicity: use prompt-based quick auth for demo OR integrate Supabase UI
      const action = prompt('Digite "login" para entrar ou "register" para criar conta:');
      if (!action) return;
      if (action === 'register') {
        const fullName = prompt('Nome completo:');
        const profileName = prompt('Nome de perfil (ex: Cliente123):');
        const email = prompt('Email:');
        const password = prompt('Senha (mín 6 caracteres):');
        if (!email || !password) return alert('Email e senha são obrigatórios.');
        // Create user via Supabase auth
        supabase.auth.signUp({ email, password }, { data: { full_name: fullName, profile_name: profileName } })
          .then(res => {
            if (res.error) return alert('Erro no cadastro: ' + res.error.message);
            alert('Cadastro realizado. Verifique seu email (se requerido). Faça login.');
          });
      } else if (action === 'login') {
        const email = prompt('Email:');
        const password = prompt('Senha:');
        if (!email || !password) return;
        supabase.auth.signInWithPassword({ email, password }).then(async res => {
          if (res.error) return alert('Erro no login: ' + res.error.message);
          // load profile
          CURRENT_USER = { id: res.data.user.id, profileName: res.data.user.user_metadata?.profile_name || email, email };
          updateAuthDisplay();
          await loadUserProfile();
          showSection('user-profile');
        });
      }
    }
    window.openAuthModal = openAuthModal;

    async function updateAuthDisplay() {
      // check supabase session or fallback to mock CURRENT_USER
      const { data } = await supabase.auth.getSession();
      const session = data?.session || null;
      const user = session ? session.user : CURRENT_USER;
      const authState = document.getElementById('auth-state');
      const userDisplay = document.getElementById('user-display');
      if (user) {
        authState.style.display = 'none';
        userDisplay.style.display = 'flex';
        document.getElementById('user-initial').textContent = (user.user_metadata?.profile_name || (CURRENT_USER && CURRENT_USER.profileName) || 'U').charAt(0).toUpperCase();
        document.getElementById('user-welcome').textContent = user.user_metadata?.profile_name || (CURRENT_USER && CURRENT_USER.profileName) || user.email;
      } else {
        authState.style.display = 'flex';
        userDisplay.style.display = 'none';
      }
    }
    window.updateAuthDisplay = updateAuthDisplay;

    async function logoutUser() {
      await supabase.auth.signOut();
      CURRENT_USER = null;
      updateAuthDisplay();
      showSection('hero');
    }
    window.logoutUser = logoutUser;

    async function loadUserProfile() {
      const { data } = await supabase.auth.getSession();
      const session = data?.session || null;
      if (!session && !CURRENT_USER) return;
      // Try to load user from Supabase users table if exists; fallback to mock
      // For demo we'll use CURRENT_USER if set
      renderUserProfile();
    }

    /*******************
     * RENDER PROFILE
     *******************/
    function renderUserProfile() {
      if (!CURRENT_USER) {
        document.getElementById('profile-content').style.display = 'none';
        return;
      }
      document.getElementById('profile-content').style.display = 'block';
      const view = document.getElementById('personal-data-view');
      view.innerHTML = `
        <div><strong>Nome</strong><div>${CURRENT_USER.firstName || CURRENT_USER.profileName || ''} ${CURRENT_USER.lastName || ''}</div></div>
        <div><strong>Perfil</strong><div>${CURRENT_USER.profileName || ''}</div></div>
        <div><strong>Email</strong><div>${CURRENT_USER.email || ''}</div></div>
        <div><strong>Local</strong><div>${CURRENT_USER.city || ''}, ${CURRENT_USER.state || ''}</div></div>
      `;

      const purchasedList = document.getElementById('purchased-materials');
      if (CURRENT_USER.purchases && CURRENT_USER.purchases.length > 0) {
        purchasedList.innerHTML = CURRENT_USER.purchases.map(p => `
          <li style="display:flex;justify-content:space-between;align-items:center;padding:8px;border-radius:6px;border:1px solid var(--border-dark);margin-bottom:8px">
            <div>
              <strong style="color:var(--gold)">${p.title}</strong><div style="font-size:0.9rem;color:var(--text-light);opacity:0.9">${p.code} • ${p.date}</div>
            </div>
            <div>
              <!-- Open viewer in a new window (view only) -->
              <button class="btn btn-small" onclick="openViewer('${p.fileUrl}')">Abrir</button>
            </div>
          </li>
        `).join('');
      } else {
        purchasedList.innerHTML = '<li>Nenhum material adquirido ainda.</li>';
      }
    }

    function openViewer(fileUrl) {
      // Open a viewer page (for security you can embed viewer inside your app)
      // If you want "visualização apenas no site" -> open in a new window to a viewer route
      window.open(fileUrl, '_blank', 'noopener');
    }
    window.openViewer = openViewer;

    /*******************
     * CATEGORIES & PRODUCTS
     *******************/
    function renderCategoryCards() {
      const container = document.getElementById('category-cards-container');
      container.innerHTML = MOCK_CATEGORIES.map(cat => {
        const disabled = cat.status === 'disabled';
        return `
          <div class="category-card ${disabled ? 'disabled' : ''}" ${disabled ? '' : `onclick="selectCategory(${cat.id})"`}>
            <span class="material-symbols-outlined">${cat.icon}</span>
            <h4 style="margin-top:10px">${cat.name.toUpperCase()}</h4>
            <p style="margin-top:8px;color:var(--text-light);opacity:0.9">${cat.description}${disabled ? ' (EM BREVE)' : ''}</p>
          </div>
        `;
      }).join('');
    }

    function selectCategory(categoryId) {
      const cat = MOCK_CATEGORIES.find(c => c.id === categoryId);
      if (!cat) return;
      document.getElementById('current-category-title').textContent = cat.name;
      document.getElementById('products').style.display = 'block';
      renderProducts(categoryId);
      showSection('categories');
    }

    function renderProducts(categoryId) {
      const container = document.getElementById('products-container');
      const filtered = MOCK_PRODUCTS.filter(p => p.categoryId === categoryId);
      if (!filtered || filtered.length === 0) {
        container.innerHTML = `<p style="text-align:center;color:var(--text-light);opacity:0.8">Nenhum produto disponível nesta categoria no momento.</p>`;
        return;
      }
      container.innerHTML = filtered.map(p => `
        <div class="product-card">
          <h4 style="color:var(--gold)">${p.country} — ${p.city}</h4>
          <p style="margin:8px 0;color:var(--text-light);opacity:0.9">${p.description}</p>
          <div class="product-price">R$ ${p.price.toFixed(2).replace('.', ',')}</div>
          <div style="display:flex;gap:8px;justify-content:center">
            <button class="btn btn-primary" onclick="openCheckoutModal(${p.id})">Comprar</button>
            <button class="btn btn-outline" onclick="openColumnModalPreview(${p.id})">Detalhes</button>
          </div>
        </div>
      `).join('');
    }

    /*******************
     * CHECKOUT (Payment Link approach)
     *
     * Flow:
     *  - Admin adds a product with a paymentLink (Stripe Payment Link).
     *  - Client clicks "Comprar" -> opens the paymentLink in new tab.
     *  - After payment, Stripe can redirect to a success URL or you implement a webhook.
     *  - For demo, user can click "Confirmar Recebimento" to add the purchase to profile.
     *
     *******************/
    function openCheckoutModal(productId) {
      if (!CURRENT_USER) {
        alert('Você precisa estar logado para realizar uma compra.');
        openAuthModal('login');
        return;
      }
      const product = MOCK_PRODUCTS.find(p => p.id === productId);
      if (!product) return;
      document.getElementById('checkout-product-name').textContent = `${product.country} — ${product.city} • ${product.code}`;
      document.getElementById('checkout-product-price').textContent = `R$ ${product.price.toFixed(2).replace('.', ',')}`;
      document.getElementById('checkout-modal').classList.add('active');

      const paymentBtn = document.getElementById('open-payment-link-btn');
      paymentBtn.onclick = () => {
        if (product.paymentLink && product.paymentLink.startsWith('http')) {
          window.open(product.paymentLink, '_blank', 'noopener');
        } else {
          // If no paymentLink provided by admin, show informational alert and fallback to Stripe docs or Payment Links creation
          alert('Forma de pagamento ainda não configurada para este produto. Você pode criar um Payment Link no Stripe Dashboard e colar o link no produto no painel admin.');
        }
      };

      // Store selected productId for manual confirm
      document.getElementById('checkout-modal').dataset.productId = productId;
    }
    window.openCheckoutModal = openCheckoutModal;

    function confirmManualPurchase() {
      // Manual confirmation (demo fallback if webhook not configured)
      const productId = parseInt(document.getElementById('checkout-modal').dataset.productId);
      if (!productId) return alert('Produto não localizado.');
      const product = MOCK_PRODUCTS.find(p => p.id === productId);
      if (!product) return alert('Produto não localizado.');

      // Save to current user's purchases (in real: verify payment server-side via webhook)
      const purchase = {
        productId: product.id,
        code: product.code,
        title: product.description,
        date: new Date().toLocaleDateString('pt-BR'),
        fileUrl: product.fileUrl
      };
      // If using Supabase, insert into purchases table linked to user id
      if (CURRENT_USER && CURRENT_USER.id) {
        CURRENT_USER.purchases = CURRENT_USER.purchases || [];
        CURRENT_USER.purchases.push(purchase);
        alert('Compra confirmada e adicionada ao seu perfil.');
        renderUserProfile();
      } else {
        alert('Usuário não identificado. Faça login para registrar a compra.');
      }
      closeModal('checkout-modal');
    }
    window.confirmManualPurchase = confirmManualPurchase;

    /*******************
     * COLUMNS display
     *******************/
    function renderColumns() {
      const container = document.getElementById('columns-container');
      container.innerHTML = MOCK_COLUMNS.map(col => `
        <div class="card column-card" onclick="openColumnModal(${col.id})">
          <h4 style="color:var(--gold)">${col.title}</h4>
          <div style="color:var(--text-light);opacity:0.9;margin-top:8px">${col.content.substring(0, 140)}...</div>
          <div style="margin-top:10px;color:var(--text-light);opacity:0.75;font-size:0.9rem">Publicado em ${col.date}</div>
        </div>
      `).join('');
    }

    function openColumnModal(columnId) {
      const col = MOCK_COLUMNS.find(c => c.id === columnId);
      if (!col) return;
      document.getElementById('modal-column-title').textContent = col.title;
      document.getElementById('modal-column-date').textContent = `Publicado em ${col.date}`;
      document.getElementById('modal-column-content').textContent = col.content;
      document.getElementById('column-modal').classList.add('active');
    }
    window.openColumnModal = openColumnModal;

    /*******************
     * CONTACT FORM (calls serverless endpoint)
     *******************/
    async function sendContactEmail(e) {
      e.preventDefault();
      const f = document.getElementById('contactForm');
      const feedback = document.getElementById('contact-feedback');
      feedback.style.display = 'block';
      feedback.className = 'feedback';
      feedback.textContent = 'Enviando...';

      const payload = {
        name: f.from_name.value,
        email: f.from_email.value,
        subject: f.subject.value,
        message: f.message.value
      };

      try {
        // Try serverless endpoint first
        const res = await fetch(SEND_CONTACT_ENDPOINT, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });
        if (res.ok) {
          feedback.className = 'feedback success';
          feedback.textContent = 'Mensagem enviada com sucesso!';
          f.reset();
          return setTimeout(() => feedback.style.display = 'none', 3000);
        } else {
          // fallback: open mail client
          feedback.className = 'feedback error';
          feedback.textContent = 'Não foi possível enviar automaticamente. Abra seu cliente de email.';
          setTimeout(() => {
            window.location.href = `mailto:curadoriaelitetravel@gmail.com?subject=${encodeURIComponent(payload.subject)}&body=${encodeURIComponent(payload.message + '\n\n--\n' + payload.name + '\n' + payload.email)}`;
            feedback.style.display = 'none';
          }, 1200);
        }
      } catch (err) {
        console.error(err);
        feedback.className = 'feedback error';
        feedback.textContent = 'Erro ao enviar. Abrindo cliente de email...';
        setTimeout(() => {
          window.location.href = `mailto:curadoriaelitetravel@gmail.com?subject=${encodeURIComponent(payload.subject)}&body=${encodeURIComponent(payload.message + '\n\n--\n' + payload.name + '\n' + payload.email)}`;
          feedback.style.display = 'none';
        }, 1200);
      }
    }
    window.sendContactEmail = sendContactEmail;

    /*******************
     * REVIEWS
     *******************/
    function renderRatingStars() {
      const container = document.getElementById('rating-stars');
      container.innerHTML = '';
      for (let i = 1; i <= 5; i++) {
        const el = document.createElement('i');
        el.className = 'fas fa-star' + (i <= selectedRating ? ' selected' : '');
        el.dataset.value = i;
        el.onclick = () => {
          selectedRating = (selectedRating === i) ? 0 : i;
          renderRatingStars();
          updateRatingLegend();
        };
        container.appendChild(el);
      }
      updateRatingLegend();
    }

    function updateRatingLegend() {
      const legend = document.getElementById('rating-legend');
      let txt = 'Clique nas estrelas para nos avaliar';
      if (selectedRating >= 1 && selectedRating <= 2) txt = '1 a 2 Estrelas - Muito ruim';
      else if (selectedRating === 3) txt = '3 Estrelas - Regular';
      else if (selectedRating === 4) txt = '4 Estrelas - Bom';
      else if (selectedRating === 5) txt = '5 Estrelas - Excelente';
      legend.textContent = txt;
    }

    function submitReview(e) {
      e.preventDefault();
      const fb = document.getElementById('review-feedback');
      if (selectedRating === 0) {
        fb.style.display = 'block';
        fb.className = 'feedback error';
        fb.textContent = 'Por favor, selecione uma nota de 1 a 5 estrelas.';
        return;
      }
      const review = {
        rating: selectedRating,
        name: document.getElementById('review-nome').value,
        lastName: document.getElementById('review-sobrenome').value,
        email: document.getElementById('review-email').value,
        gender: document.getElementById('review-genero').value,
        birthDate: document.getElementById('review-aniversario').value,
        state: document.getElementById('review-estado').value,
        city: document.getElementById('review-cidade').value,
        type: document.getElementById('review-tipo').value,
        comment: document.getElementById('review-comentario').value,
        date: new Date().toISOString()
      };
      MOCK_REVIEWS.push(review);
      MOCK_STATS.reviews++;
      fb.style.display = 'block';
      fb.className = 'feedback success';
      fb.textContent = 'Sua avaliação foi enviada com sucesso! Obrigado pelo seu feedback.';
      document.getElementById('submit-review-form').reset();
      selectedRating = 0;
      renderRatingStars();
      setTimeout(() => fb.style.display = 'none', 3000);
    }
    window.submitReview = submitReview;

    /*******************
     * ADMIN minimal (local)
     *******************/
    function openAdminLoginModal() {
      document.getElementById('admin-login-modal').classList.add('active');
      document.getElementById('admin-login-feedback').style.display = 'none';
    }
    window.openAdminLoginModal = openAdminLoginModal;

    function adminLogin() {
      const email = document.getElementById('admin-email').value;
      const password = document.getElementById('admin-password').value;
      const fb = document.getElementById('admin-login-feedback');
      const ADMIN_EMAIL = 'admin@elitetravel.com';
      const ADMIN_PASSWORD = 'admin@123';
      if (email === ADMIN_EMAIL && password === ADMIN_PASSWORD) {
        localStorage.setItem('isAdminLoggedIn', 'true');
        document.getElementById('admin-login-modal').classList.remove('active');
        document.getElementById('admin').style.display = 'block';
        renderAdminForms();
      } else {
        fb.style.display = 'block';
        fb.className = 'feedback error';
        fb.textContent = 'Credenciais de Admin incorretas.';
      }
    }
    window.adminLogin = adminLogin;

    function adminLogout() {
      localStorage.removeItem('isAdminLoggedIn');
      document.getElementById('admin').style.display = 'none';
      showSection('hero');
    }
    window.adminLogout = adminLogout;

    function showAdminSection(name) {
      const container = document.getElementById('admin-forms');
      container.innerHTML = '';
      if (name === 'category') {
        container.innerHTML = `
          <h3>Gerenciar Categorias</h3>
          <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:8px">
            <input id="new-category-name" placeholder="Nome da Categoria" style="flex:1" />
            <input id="new-category-icon" placeholder="Ícone (ex: map)" style="flex:1" />
            <input id="new-category-price" placeholder="Preço padrão (R$)" style="width:160px" />
            <select id="new-category-status"><option value="enabled">Ativo</option><option value="disabled">EM BREVE</option></select>
            <button class="btn" onclick="addCategory()">Adicionar</button>
          </div>
          <div id="existing-categories" style="margin-top:12px"></div>
        `;
        renderAdminCategoryList();
      } else if (name === 'product') {
        container.innerHTML = `
          <h3>Gerenciar Produtos</h3>
          <div style="margin-top:8px;display:grid;grid-template-columns:1fr;gap:8px">
            <input id="new-product-code" placeholder="Código do Produto (ex: CG-PAR-24)" />
            <select id="new-product-category"></select>
            <div style="display:flex;gap:8px">
              <input id="new-product-country" placeholder="País" style="flex:1"/>
              <input id="new-product-city" placeholder="Cidade" style="flex:1"/>
            </div>
            <input id="new-product-price" placeholder="Preço (R$)" />
            <input id="new-product-file" placeholder="Arquivo PDF (URL público)" />
            <input id="new-product-paymentlink" placeholder="Payment Link (Stripe URL)" />
            <textarea id="new-product-description" placeholder="Descrição do produto" rows="3"></textarea>
            <div style="text-align:right">
              <button class="btn" onclick="addProduct()">Adicionar Produto</button>
            </div>
          </div>
          <div id="existing-products" style="margin-top:12px"></div>
        `;
        renderAdminCategorySelect();
        renderAdminProductList();
      } else if (name === 'columns') {
        container.innerHTML = `
          <h3>Gerenciar Colunas</h3>
          <input id="new-column-title" placeholder="Título" />
          <input id="new-column-date" placeholder="DD/MM/AAAA" />
          <textarea id="new-column-content" placeholder="Conteúdo" rows="4"></textarea>
          <div style="text-align:right;margin-top:8px"><button class="btn" onclick="addColumn()">Adicionar Coluna</button></div>
          <div id="existing-columns" style="margin-top:12px"></div>
        `;
        renderAdminColumnsList();
      } else if (name === 'export') {
        container.innerHTML = `<h3>Exportar dados (clicar para gerar Excel local)</h3>
          <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:8px">
            <select id="export-data-type"><option value="users">Cadastros</option><option value="reviews">Avaliações</option><option value="purchases">Compras</option></select>
            <button class="btn" onclick="exportDataToExcel()">Exportar</button>
          </div>`;
      }
    }

    function renderAdminForms() {
      // if admin logged show admin section
      if (localStorage.getItem('isAdminLoggedIn') === 'true') {
        document.getElementById('admin').style.display = 'block';
        showAdminSection('product');
      }
    }

    function addCategory() {
      const name = document.getElementById('new-category-name').value;
      const icon = document.getElementById('new-category-icon').value || 'map';
      const price = parseFloat(document.getElementById('new-category-price').value) || 0;
      const status = document.getElementById('new-category-status').value || 'enabled';
      if (!name) return alert('Nome da categoria é obrigatório');
      const newCat = { id: (MOCK_CATEGORIES.length ? MOCK_CATEGORIES[MOCK_CATEGORIES.length - 1].id + 1 : 1), name, icon, price, status, description: '' };
      MOCK_CATEGORIES.push(newCat);
      renderCategoryCards();
      alert(`Categoria "${name}" adicionada.`);
      renderAdminCategoryList();
      renderAdminCategorySelect();
    }

    function renderAdminCategoryList() {
      const el = document.getElementById('existing-categories');
      if (!el) return;
      el.innerHTML = MOCK_CATEGORIES.map(c => `<div style="display:flex;justify-content:space-between;padding:8px;border:1px solid var(--border-dark);margin-bottom:6px;border-radius:6px"><div><strong>${c.name}</strong> • ${c.status}</div><div><button class="btn btn-small btn-outline" onclick="deleteCategory(${c.id})">Excluir</button></div></div>`).join('');
    }

    function deleteCategory(id) {
      MOCK_CATEGORIES = MOCK_CATEGORIES.filter(c => c.id !== id);
      renderCategoryCards();
      renderAdminCategoryList();
      renderAdminCategorySelect();
    }

    function renderAdminCategorySelect() {
      const select = document.getElementById('new-product-category');
      if (!select) return;
      select.innerHTML = '<option value="">Selecione...</option>';
      MOCK_CATEGORIES.forEach(c => {
        const opt = document.createElement('option');
        opt.value = c.id;
        opt.textContent = c.name;
        select.appendChild(opt);
      });
    }

    function addProduct() {
      const code = document.getElementById('new-product-code').value;
      const categoryId = parseInt(document.getElementById('new-product-category').value);
      const country = document.getElementById('new-product-country').value;
      const city = document.getElementById('new-product-city').value;
      const price = parseFloat(document.getElementById('new-product-price').value) || 0;
      const fileUrl = document.getElementById('new-product-file').value;
      const paymentLink = document.getElementById('new-product-paymentlink').value;
      const description = document.getElementById('new-product-description').value;
      if (!code || !categoryId) return alert('Código e categoria obrigatórios.');
      const newProd = { id: (MOCK_PRODUCTS.length ? MOCK_PRODUCTS[MOCK_PRODUCTS.length - 1].id + 1 : 101), code, categoryId, country, city, price, description, fileUrl, paymentLink };
      MOCK_PRODUCTS.push(newProd);
      renderProducts(categoryId);
      renderAdminProductList();
      alert(`Produto ${code} adicionado.`);
    }

    function renderAdminProductList() {
      const el = document.getElementById('existing-products');
      if (!el) return;
      el.innerHTML = MOCK_PRODUCTS.map(p => `<div style="display:flex;justify-content:space-between;padding:8px;border:1px solid var(--border-dark);margin-bottom:6px;border-radius:6px"><div><strong>${p.code}</strong> — ${p.city} • R$ ${p.price.toFixed(2).replace('.',',')}</div><div><button class="btn btn-small btn-outline" onclick="deleteProduct(${p.id})">Excluir</button></div></div>`).join('');
    }

    function deleteProduct(id) {
      MOCK_PRODUCTS = MOCK_PRODUCTS.filter(p => p.id !== id);
      renderAdminProductList();
      renderProducts();
    }

    function addColumn() {
      const title = document.getElementById('new-column-title').value;
      const date = document.getElementById('new-column-date').value;
      const content = document.getElementById('new-column-content').value;
      if (!title || !content) return alert('Título e conteúdo obrigatórios.');
      const newCol = { id: (MOCK_COLUMNS.length ? MOCK_COLUMNS[MOCK_COLUMNS.length - 1].id + 1 : 1), title, date, content };
      MOCK_COLUMNS.push(newCol);
      renderColumns();
      renderAdminColumnsList();
      alert(`Coluna "${title}" adicionada.`);
    }

    function renderAdminColumnsList() {
      const el = document.getElementById('existing-columns');
      if (!el) return;
      el.innerHTML = MOCK_COLUMNS.map(c => `<div style="display:flex;justify-content:space-between;padding:8px;border:1px solid var(--border-dark);margin-bottom:6px;border-radius:6px"><div><strong>${c.title}</strong> • ${c.date}</div><div><button class="btn btn-small btn-outline" onclick="deleteColumn(${c.id})">Excluir</button></div></div>`).join('');
    }

    function deleteColumn(id) {
      MOCK_COLUMNS = MOCK_COLUMNS.filter(c => c.id !== id);
      renderColumns();
      renderAdminColumnsList();
    }

    /*******************
     * EXPORT (Excel) - client side using simple CSV (for basic needs)
     *******************/
    function exportDataToExcel() {
      const type = document.getElementById('export-data-type').value;
      let rows = [];
      if (type === 'users') {
        rows = MOCK_USERS.map(u => [u.id, u.firstName || '', u.lastName || '', u.email, u.profileName, u.birthDate, u.state, u.city]);
        downloadCSV(rows, ['ID','Nome','Sobrenome','Email','Perfil','DataNasc','Estado','Cidade'], 'cadastros');
      } else if (type === 'reviews') {
        rows = MOCK_REVIEWS.map(r => [r.date, r.rating, r.type, r.comment, r.email, r.city, r.state]);
        downloadCSV(rows, ['Data','Nota','Tipo','Comentario','Email','Cidade','Estado'], 'avaliacoes');
      } else if (type === 'purchases') {
        const purchases = MOCK_USERS.flatMap(u => u.purchases.map(p => [p.date, u.email, p.code, p.title]));
        downloadCSV(purchases, ['Data','UsuarioEmail','Codigo','Titulo'], 'compras');
      }
    }

    function downloadCSV(rows, headers, filename) {
      let csv = headers.join(',') + '\n';
      rows.forEach(r => {
        csv += r.map(cell => `"${(cell||'').toString().replace(/"/g,'""')}"`).join(',') + '\n';
      });
      const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement('a');
      link.href = URL.createObjectURL(blob);
      link.setAttribute('download', `${filename}_${new Date().toISOString().slice(0,10)}.csv`);
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }

    /*******************
     * Small helpers
     *******************/
    function openColumnModalPreview(productId) {
      // If productId used as column preview, fallback
      alert('Detalhes rápidos do produto (implemente modal avançado se desejar).');
    }

    // Initialize rendering for lists
    renderCategoryCards();
    renderColumns();
    renderRatingStars();

    /*******************
     * Final notes to you (owner)
     *
     * - To fully automate purchase confirmation:
     *   1) Create Stripe Payment Links for each product (Dashboard > Payment Links).
     *   2) In "new-product-paymentlink", paste that URL for each product.
     *   3) Configure a webhook server (Vercel / Netlify / Supabase Edge Function) to receive checkout.completed
     *      And there: validate event and call Supabase to add purchase to the user.
     *
     * - For contact form: implement SEND_CONTACT_ENDPOINT serverless function (SendGrid) to send an email to curadoriaelitetravel@gmail.com.
     *
     * - For security: never store card numbers in Supabase or client. Use Stripe Checkout / Payment Links to handle card data.
     *
     *******************/
  </script>

</body>
</html>
