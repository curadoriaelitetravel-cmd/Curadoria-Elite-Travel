<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Curadoria Elite Travel - O seu mundo, perfeitamente indicado</title>

  <!-- ICONS & FONTS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" crossorigin="anonymous"/>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet" />

  <style>
  /* ==================== 0. VARIÁVEIS DE TEMA ==================== */
:root{--gold-color:#D4AF37;--bg-dark:#121212;--text-light:#f1f1f1;--card-dark:#1e1e1e;--border-dark:#333333;--bg-light:#ffffff;--text-dark:#333333;--card-light:#f9f9f9;--border-light:#dddddd;--primary-color:var(--gold-color);--secondary-color:#555555;--bg-color:var(--bg-dark);--text-color:var(--text-light);--card-bg:var(--card-dark);--border-color:var(--border-dark);--text-secondary:#aaaaaa;--box-shadow-color:rgba(0,0,0,0.5);--btn-hover-bg:#E1C16E}
.light-theme{--bg-color:var(--bg-light);--text-color:var(--text-dark);--card-bg:var(--card-light);--border-color:var(--border-light);--text-secondary:#666666;--box-shadow-color:rgba(0,0,0,0.1);--btn-hover-bg:#E1C16E}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Playfair Display',serif;background:var(--bg-color);color:var(--text-color);line-height:1.6;transition:background .4s,color .4s}
.container{width:90%;max-width:1200px;margin:0 auto}
h1,h2,h3,h4{font-family:'Cinzel',serif;color:var(--primary-color);text-transform:uppercase}
a{color:var(--gold-color);text-decoration:none}
a:hover{color:var(--btn-hover-bg)}
section{padding:80px 0;display:none;position:relative;background-size:cover;background-position:center}
section::before{content:'';position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.6);z-index:1}
section .container{position:relative;z-index:2}
section.active{display:block}
#hero{background-image:url('https://picsum.photos/1920/1080?random=1&blur=2');height:70vh;display:flex;align-items:center;text-align:center}
#about-us{background-image:url('https://picsum.photos/1920/1080?random=2&blur=2')}
#categories{background-image:url('https://picsum.photos/1920/1080?random=3&blur=2')}
#daily-columns{background-image:url('https://picsum.photos/1920/1080?random=4&blur=2')}
#contact-form{background-image:url('https://picsum.photos/1920/1080?random=5&blur=2')}
#hero .hero-content,#about-us .container,#categories .container,#daily-columns .container,#contact-form .container{color:var(--text-light)}
.btn{padding:10px 20px;border:2px solid var(--primary-color);border-radius:4px;cursor:pointer;font-weight:bold;text-transform:uppercase;font-family:'Cinzel',serif;transition:all .3s;min-width:120px}
.btn-small{padding:5px 10px;min-width:80px;font-size:.8rem}
.btn-primary{background:var(--primary-color);color:var(--bg-dark);border-color:var(--primary-color)}
.btn-primary:hover{background:var(--btn-hover-bg);border-color:var(--btn-hover-bg)}
.btn-outline{background:transparent;color:var(--primary-color);border:2px solid var(--primary-color)}
.btn-outline:hover{background:var(--primary-color);color:var(--bg-dark)}
.logout-btn{background:transparent;color:var(--primary-color);border:none;padding:5px 10px;cursor:pointer;font-size:.9rem;text-decoration:underline}
.theme-toggle-footer{background:none;border:none;cursor:pointer;font-size:2.5rem;color:var(--primary-color);display:block;margin:0 auto 5px;padding:0}
input[type="text"],input[type="email"],input[type="password"],input[type="number"],textarea,select{width:100%;padding:12px;margin-bottom:15px;border:1px solid var(--border-color);border-radius:4px;background:var(--card-bg);color:var(--text-color);font-family:'Playfair Display',serif}
textarea{resize:vertical}.form-group label{display:block;margin-bottom:5px;font-weight:bold;color:var(--text-secondary)}.form-row{display:flex;gap:15px}.form-row>*{flex:1}@media(max-width:768px){.form-row{flex-direction:column}}
header{background:var(--card-bg);box-shadow:0 2px 10px var(--box-shadow-color);position:sticky;top:0;z-index:100}
.header-content{display:flex;justify-content:space-between;align-items:center;padding:15px 0}
.logo-image{display:flex;align-items:center}.logo-text h1{font-size:1.2rem;margin:0;color:var(--text-color)}.logo-text span{display:block;font-size:.8rem;color:var(--gold-color)}nav ul{list-style:none;display:flex}nav ul li{margin-left:20px}nav ul li a{color:var(--text-color);text-transform:uppercase;font-size:.9rem;font-weight:bold;padding:5px;border-bottom:2px solid transparent}nav ul li a:hover{color:var(--gold-color);border-bottom:2px solid var(--gold-color)}
.hero-content{position:relative;z-index:1;color:var(--text-light)}.hero-content h2{font-size:3rem;margin-bottom:10px;color:var(--gold-color)}.hero-content p.lead{font-size:1.2rem;margin-bottom:10px;font-family:'Cinzel',serif;font-weight:400}.social-icons{margin-bottom:20px;display:flex;justify-content:center;gap:20px}.social-icons a{font-size:2rem;color:var(--text-light)}.social-icons a:hover{color:var(--gold-color)}
.modal{display:none;position:fixed;z-index:200;left:0;top:0;width:100%;height:100%;overflow:auto;background-color:rgba(0,0,0,.8);backdrop-filter:blur(5px)}
.modal-content{background:var(--card-bg);margin:8% auto;padding:30px;border:1px solid var(--primary-color);width:90%;max-width:500px;border-radius:8px;box-shadow:0 5px 15px var(--box-shadow-color);position:relative}
.close-btn{color:var(--text-secondary);float:right;font-size:28px;font-weight:bold}.close-btn:hover{color:var(--primary-color);cursor:pointer}@keyframes fadeIn{from{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}
.admin-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:30px;border-bottom:2px solid var(--gold-color);padding-bottom:10px}.stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:20px;margin-bottom:30px}.stat-card{background:var(--bg-dark);padding:15px;border-radius:6px;text-align:center;border-left:4px solid var(--primary-color)}
.card{background:var(--card-bg);padding:30px;border-radius:8px;box-shadow:0 4px 8px var(--box-shadow-color);border:1px solid var(--border-color);transition:transform .3s;border-left:1px solid var(--border-color)}.grid-3{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:30px}.categories-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:15px;margin-bottom:40px}
.category-card{background:var(--card-bg);padding:15px;border-radius:8px;text-align:center;border:2px solid var(--border-color);display:flex;flex-direction:column;align-items:center;justify-content:center;transition:all .3s}
.category-card:hover{border-color:var(--gold-color);transform:scale(1.05)}.category-card.disabled{opacity:.5;cursor:not-allowed}.category-card .material-symbols-outlined{font-size:2.5rem;color:var(--gold-color);margin-bottom:10px;font-variation-settings:'FILL' 1,'wght' 400,'GRAD' 0,'opsz' 48}.product-card{background:var(--card-bg);padding:20px;border-radius:8px;border:1px solid var(--border-color);text-align:center;transition:transform .3s}.product-card:hover{transform:translateY(-5px);border-color:var(--gold-color)}.product-price{font-size:1.5rem;color:var(--gold-color);font-weight:bold;margin:15px 0}
.rating-section{background:var(--card-bg);padding:30px;border-radius:8px;border:1px solid var(--primary-color);margin-bottom:30px;text-align:center}.stars{font-size:2.5rem;margin-bottom:15px}.star{color:var(--text-secondary);cursor:pointer;transition:color .2s,transform .1s}.star:hover{transform:scale(1.1)}.star.selected{color:#FFC107}
.site-footer{background:var(--card-bg);color:var(--text-light);padding:30px 0;border-top:2px solid var(--gold-color)}.footer-content{display:flex;justify-content:space-between;flex-wrap:wrap;gap:20px}.footer-left{flex:1 1 45%;min-width:300px}.footer-right{flex:1 1 45%;min-width:300px;text-align:right;display:flex;flex-direction:column;justify-content:space-between}.contact-info{display:flex;flex-direction:column;align-items:flex-end;margin-bottom:15px}.contact-item{display:flex;align-items:center;margin-bottom:5px;color:var(--text-secondary)}.contact-item i{margin-left:10px;color:var(--gold-color);font-size:1.2rem}.footer-bottom{width:100%;text-align:center;border-top:1px solid var(--border-color);padding-top:15px;margin-top:20px;font-size:.8rem;color:var(--text-secondary)}@media(max-width:768px){nav ul{display:none}.footer-content{flex-direction:column;text-align:center}.footer-left{text-align:center;min-width:100%;margin-bottom:20px}.footer-right{text-align:center;align-items:center;min-width:100%}.contact-info{align-items:center}.category-card{min-height:140px}}.feedback-message{padding:10px;margin-top:15px;border-radius:4px;font-weight:bold;font-size:.9rem;display:block}.feedback-success{background-color:#388e3c33;color:#4CAF50}.feedback-error{background-color:#d32f2f33;color:#F44336}

/* Quem Somos specific styles */
#about-us .about-inner{max-width:900px;margin:0 auto;text-align:center}
.about-cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:24px;margin-top:30px}
.about-card{background:var(--card-bg);padding:24px;border-radius:8px;border:1px solid var(--border-color);cursor:pointer;position:relative}
.about-card h4{margin-bottom:10px}
.about-card p{color:var(--text-secondary)}

  </style>
</head>
<body>

  <header>
    <div class="container">
      <div class="header-content">
        <a href="#hero" class="logo" onclick="showSection('hero')">
          <div class="logo-image">
            <div class="compass-icon">
              <div class="compass-rose">
                <div class="compass-line compass-line-h"></div>
                <div class="compass-line compass-line-v"></div>
                <div class="compass-line compass-line-ne"></div>
                <div class="compass-line compass-line-nw"></div>
                <div class="compass-center"></div>
                <span class="compass-direction compass-n">N</span>
              </div>
            </div>
            <div class="logo-text">
              <h1>Curadoria Elite Travel</h1>
              <span>O seu mundo, perfeitamente indicado.</span>
            </div>
          </div>
        </a>

        <nav>
          <ul>
            <li><a href="#hero" onclick="showSection('hero')">Início</a></li>
            <li><a href="#about-us" onclick="showSection('about-us')">Quem Somos</a></li>
            <li><a href="#categories" onclick="showSection('categories')">Curadoria</a></li>
            <li><a href="#daily-columns" onclick="showSection('daily-columns')">Colunas</a></li>
            <li><a href="#review-form" onclick="showSection('review-form')">Avalie-nos</a></li>
            <li><a href="#contact-form" onclick="showSection('contact-form')">Contato</a></li>
          </ul>
        </nav>

        <div class="auth-buttons">
          <button class="btn btn-small btn-admin" onclick="openAdminLoginModal()">Admin</button>

          <div id="auth-state">
            <button class="btn btn-small btn-outline" onclick="openAuthModal('login')">Entrar ou Cadastrar</button>
          </div>
          
          <div class="user-info" id="user-display">
            <div class="user-avatar" onclick="showSection('user-profile')">
              <span id="user-initial">C</span>
            </div>
            <span class="user-name" id="user-welcome">Olá, Cliente!</span>
            <a href="#" class="logout-btn" onclick="logoutUser()">Sair</a>
          </div>
        </div>
      </div>
    </div>
  </header>

  <section id="hero" class="active">
    <div class="container">
      <div class="hero-content">
        <h2>Curadoria Elite Travel</h2>
        <p class="lead">Orquestramos cada detalhe com cuidado e expertise — você vive as experiências.</p>
        <p>Curadoria exclusiva para as experiências de viagem mais inesquecíveis.</p>

        <div class="social-icons">
          <a href="LINK_INSTAGRAM" target="_blank" title="Instagram"><i class="fab fa-instagram"></i></a>
          <a href="LINK_LINKEDIN" target="_blank" title="LinkedIn"><i class="fab fa-linkedin-in"></i></a>
        </div>

        <button class="btn btn-primary btn-curadoria" onclick="showSection('categories')">Descubra nossas Curadorias</button>
      </div>
    </div>
  </section>

  <!-- ABOUT / QUEM SOMOS -->
  <section id="about-us">
    <div class="container">
      <div class="about-inner">
        <h2>Quem Somos</h2>
        <p style="margin-top:16px; text-align:center; color:var(--text-light);">
          Na Curadoria Elite Travel, acreditamos que seu tempo é seu bem mais valioso. Percebemos que, em um mundo onde a praticidade digital é essencial, o viajante moderno buscava autonomia sem abrir mão de inspiração e confiança – uma assistência ágil e personalizada que ainda não existia. Foi dessa necessidade que nascemos: somos a resposta para quem deseja explorar o mundo de forma inteligente, com curadorias que transformam destinos em universos referenciados e acessíveis digitalmente. Abraçamos essa missão com excelência, oferecendo narrativas turísticas sob medida para que sua próxima aventura seja não apenas planejada, mas vivida intensamente, mesmo antes de partir. O seu mundo, bem indicado.
        </p>

        <div class="about-cards" style="margin-top:28px;">
          <div class="about-card" data-popup-title="VISÃO" data-popup-content="Ser a principal referência digital para quem busca apoio, inspiração e orientação em viagens, oferecendo uma curadoria de alto nível que torna a descoberta de destinos mais clara, elegante e acessível — um ponto de partida confiável para explorar o mundo com profundidade e propósito.">
            <h4>VISÃO</h4>
            <p>Ser referência digital em curadoria de viagens.</p>
          </div>

          <div class="about-card" data-popup-title="MISSÃO" data-popup-content="Oferecer materiais de apoio que iluminam a escolha dos melhores lugares, reunindo conteúdo de qualidade, excelência na seleção e uma visão equilibrada entre experiência e valor.">
            <h4>MISSÃO</h4>
            <p>Oferecer materiais de apoio e curadorias com excelência.</p>
          </div>

          <div class="about-card" data-popup-title="NICHO" data-popup-content="Viajantes que buscam experiências entre 3 e 4 estrelas, desejando conhecer os principais destinos de forma acolhedora, inteligente e cuidadosamente selecionada.">
            <h4>NICHO</h4>
            <p>Foco em viajantes que buscam experiências 3 e 4 estrelas.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- CATEGORIES, COLUMNS, REVIEWS, CONTACT, ADMIN, USER PROFILE, FOOTER -->
  <section id="categories">
    <div class="container">
      <div class="subtitle">
        <h2>Categorias de Curadoria</h2>
        <p>Navegue pelos temas que definem sua próxima aventura.</p>
      </div>

      <div class="categories-grid" id="category-cards-container"></div>

      <div id="products" style="display:none;">
        <h2>Curadorias em <span id="current-category-title"></span></h2>
        <div class="products-container" id="products-container"></div>
      </div>
    </div>
  </section>

  <section id="daily-columns">
    <div class="container">
      <div class="subtitle">
        <h2>Colunas Diárias</h2>
        <p>Dicas, inspirações e tendências do mundo das viagens.</p>
      </div>
      <div class="columns-container" id="columns-container"></div>
    </div>
  </section>

  <section id="review-form">
    <div class="container">
      <h2>Sua percepção nos ajuda a evoluir</h2>
      <p class="subtitle">Ajude-nos a manter o nível de excelência. Deixe sua avaliação.</p>

      <div class="rating-section">
        <div class="stars" id="rating-stars"></div>
        <div class="rating-legend" id="rating-legend"></div>
      </div>

      <form id="submit-review-form">
        <div class="form-row">
          <div class="form-group"><label>Nome</label><input type="text" id="review-nome" maxlength="50" required></div>
          <div class="form-group"><label>Sobrenome</label><input type="text" id="review-sobrenome" maxlength="50" required></div>
        </div>
        <div class="form-row">
          <div class="form-group"><label>Email</label><input type="email" id="review-email" required></div>
          <div class="form-group"><label>Gênero</label><input type="text" id="review-genero" required></div>
        </div>

        <div class="form-row">
          <div class="form-group"><label>Data de Aniversário</label><input type="date" id="review-aniversario" required></div>
          <div class="form-group"><label>Estado</label><input type="text" id="review-estado" maxlength="50" required></div>
          <div class="form-group"><label>Cidade</label><input type="text" id="review-cidade" maxlength="50" required></div>
        </div>

        <div class="form-group">
          <label>Tipo de Feedback</label>
          <select id="review-tipo" required>
            <option value="">Selecione</option>
            <option value="Comentário">Comentário</option>
            <option value="Sugestão">Sugestão</option>
          </select>
        </div>

        <div class="form-group">
          <label>Comentário/Sugestão (Máx. 200 caracteres)</label>
          <textarea id="review-comentario" rows="4" maxlength="200" required></textarea>
        </div>

        <div id="review-feedback" class="feedback-message" style="display:none;"></div>
        <button type="submit" class="btn btn-primary">Enviar Avaliação</button>
      </form>
    </div>
  </section>

  <section id="contact-form">
    <div class="container" style="max-width:600px;">
      <h2 style="text-align:center;">Fale Conosco</h2>
      <p style="text-align:center; color:var(--text-light); margin-bottom:30px;">Envie-nos uma mensagem, ficaremos felizes em ajudar!</p>

      <div class="card">
        <form id="contactForm">
          <div class="form-group"><label>Nome</label><input type="text" name="from_name" id="contact-name" required></div>
          <div class="form-group"><label>Email</label><input type="email" name="from_email" id="contact-email" required></div>
          <div class="form-group"><label>Assunto</label><input type="text" id="contact-subject" name="subject" required></div>
          <div class="form-group"><label>Mensagem (Máx. 300 caracteres)</label><textarea id="contact-message" name="message" maxlength="300" rows="6" required></textarea></div>

          <div id="contact-feedback" class="feedback-message" style="display:none;"></div>
          <button type="submit" class="btn btn-primary">Enviar Mensagem</button>
        </form>
      </div>
    </div>
  </section>

  <section id="admin" style="display:none;">
    <div class="container">
      <div id="admin-panel" style="display:none;">... painel admin (mantido)</div>
    </div>
  </section>

  <section id="user-profile" style="display:none;">
    <div class="container">
      <div class="profile-container" id="profile-content">
        <h2>Perfil do Cliente</h2>
        <div class="profile-section">
          <h3>Informações Pessoais <button class="btn-small btn-outline" id="toggle-personal-edit">Alterar Dados</button></h3>
          <div class="profile-data-grid" id="personal-data-view"></div>
          <div id="personal-data-edit" style="display:none;"></div>
        </div>

        <div class="profile-section bank-details">
          <h3>Dados Bancários (Visualização segura)</h3>
          <div id="bank-data-view"></div>
          <div id="bank-data-edit" style="display:none;"></div>
        </div>

        <div class="profile-section">
          <h3>Materiais Adquiridos</h3>
          <ul class="purchased-materials-list" id="purchased-materials"><li>Nenhum material adquirido ainda.</li></ul>
        </div>
      </div>
    </div>
  </section>

  <footer class="site-footer">
    <div class="container footer-content">
      <div class="footer-left">
        <h3>Curadoria Elite Travel</h3>
        <p>O seu mundo, perfeitamente indicado.</p>
      </div>

      <div class="footer-right">
        <div class="contact-info">
          <div class="contact-item">curadoriaelitetravel@gmail.com <i class="fas fa-envelope"></i></div>
          <div class="contact-item">São Paulo, SP <i class="fas fa-map-marker-alt"></i></div>
          <button class="theme-toggle-footer" id="theme-toggle-footer" title="Alternar tema"><i id="theme-icon-footer" class="fas fa-moon"></i></button>
        </div>
      </div>
    </div>
    <div class="container footer-bottom"><p>© 2025 Curadoria Elite Travel. Todos os direitos reservados.</p></div>
  </footer>

  <!-- MODALS -->
  <div id="about-popup" class="modal" aria-hidden="true"><div class="modal-content"><span class="close-btn" data-close="about-popup">&times;</span><h3 id="about-popup-title"></h3><p id="about-popup-content"></p></div></div>
  <div id="auth-modal" class="modal" aria-hidden="true"><div class="modal-content"><span class="close-btn" data-close="auth-modal">&times;</span><div class="tabs"><button class="tab-btn active" data-tab="login">Entrar</button><button class="tab-btn" data-tab="register">Cadastrar-se</button></div><div id="login-tab" class="tab-content active"><h3>Acesso à Sua Conta</h3><form id="login-form"><div class="form-group"><label>Email</label><input type="email" id="login-email" required></div><div class="form-group"><label>Senha</label><input type="password" id="login-password" required></div><div id="login-feedback" class="feedback-message" style="display:none;"></div><button class="btn btn-primary" type="submit">Entrar</button></form></div><div id="register-tab" class="tab-content"><h3>Crie Sua Conta Elite Travel</h3><form id="register-form"><div class="form-row"><div class="form-group"><label>Nome</label><input type="text" id="register-nome" required></div><div class="form-group"><label>Sobrenome</label><input type="text" id="register-sobrenome" required></div></div><div class="form-group"><label>Email</label><input type="email" id="register-email" required></div><div class="form-row"><div class="form-group"><label>Data de Nasc.</label><input type="date" id="register-nascimento" required></div><div class="form-group"><label>Estado</label><input type="text" id="register-estado" required></div><div class="form-group"><label>Cidade</label><input type="text" id="register-cidade" required></div></div><div class="form-group"><label>Nome de Perfil</label><input type="text" id="register-profile-name" required></div><div class="form-row"><div class="form-group"><label>Senha</label><input type="password" id="register-password" required></div><div class="form-group"><label>Confirmar Senha</label><input type="password" id="register-confirm-password" required></div></div><div id="register-feedback" class="feedback-message" style="display:none;"></div><button class="btn btn-primary" type="submit">Cadastrar</button></form></div></div></div>

  <!-- SCRIPTS -->
  <script>
  // ======= Mock data (dev) =======
  const MOCK_CATEGORIES = [
    { id:1, name:'City Guide', icon:'map', price:49.90, status:'enabled', description:'Roteiros completos de cidade.' },
    { id:2, name:'Restaurante', icon:'restaurant', price:29.90, status:'enabled', description:'Seleção dos melhores lugares para comer.' },
    { id:9, name:'Hoteis', icon:'hotel', price:59.90, status:'enabled', description:'Seleção de hospedagens de luxo.' }
  ];
  const MOCK_PRODUCTS = [
    { id:101, code:'CG-PAR-24', categoryId:1, country:'França', city:'Paris', price:49.90, description:'Guia de Paris 3 dias.', fileUrl:'/assets/mock_pdf_paris.pdf' }
  ];
  const MOCK_COLUMNS = [ { id:1, title:'O Despertar de Lisboa', date:'15/11/2025', content:'Lisboa...'} ];
  const MOCK_USERS = [ { id:'1', profileName:'AdminCliente', email:'cliente@elitetravel.com', password:'cliente@123', firstName:'Cliente', lastName:'Teste', birthDate:'1990-01-01', state:'São Paulo', city:'São Paulo', bankName:'', bankNumber:'', purchases:[] } ];
  let MOCK_REVIEWS = []; let MOCK_MESSAGES = []; const MOCK_STATS = { views:1245, downloads:42, sales:42*49.90, reviews:0, messages:0, profiles:MOCK_USERS.length };

  let CURRENT_USER = null; let selectedRating = 0;

  document.addEventListener('DOMContentLoaded', ()=>{
    // apply theme
    if(localStorage.getItem('theme')==='light'){ document.body.classList.add('light-theme'); document.getElementById('theme-icon-footer').className='fas fa-sun'; }
    renderCategoryCards(); renderColumns(); renderRatingStars(); bindAboutCards(); bindNav(); initContact(); initAuth();
  });

  // SPA nav
  function bindNav(){ document.querySelectorAll('nav a').forEach(a=>{ a.addEventListener('click', (e)=>{ e.preventDefault(); const href=a.getAttribute('href').replace('#',''); showSection(href); }); }); document.querySelectorAll('[data-nav]').forEach(el=>el.addEventListener('click', ()=> showSection(el.getAttribute('data-nav')))); }
  function showSection(id){ document.querySelectorAll('section').forEach(s=>s.classList.remove('active')); const target=document.getElementById(id); if(target) target.classList.add('active'); window.location.hash=id; }

  // ABOUT cards popup binding
  function bindAboutCards(){ document.querySelectorAll('.about-card').forEach(card=>{ card.addEventListener('click', ()=>{ const title=card.dataset.popupTitle; const content=card.dataset.popupContent; openAboutPopup(title, content); }); }); }
  function openAboutPopup(title,content){ const modal=document.getElementById('about-popup'); document.getElementById('about-popup-title').textContent=title; document.getElementById('about-popup-content').textContent=content; modal.style.display='block'; }

  // close modals
  document.querySelectorAll('.close-btn').forEach(btn=>btn.addEventListener('click', ()=>{ const id=btn.dataset.close; if(id) document.getElementById(id).style.display='none'; else btn.closest('.modal').style.display='none'; }));
  window.addEventListener('click',(e)=>{ document.querySelectorAll('.modal').forEach(m=>{ if(e.target===m) m.style.display='none'; }); });

  // categories/products rendering
  function renderCategoryCards(){ const c=document.getElementById('category-cards-container'); if(!c) return; c.innerHTML = MOCK_CATEGORIES.map(cat=>`<div class="category-card ${cat.status==='disabled'?'disabled':''}" ${cat.status==='enabled'?`onclick="selectCategory(${cat.id})"`:''}><span class="material-symbols-outlined">${cat.icon}</span><h4>${cat.name.toUpperCase()}</h4><p>${cat.description}${cat.status==='disabled'?' (EM BREVE)':''}</p></div>`).join(''); }
  function selectCategory(id){ const cat=MOCK_CATEGORIES.find(x=>x.id===id); if(!cat) return; document.getElementById('current-category-title').textContent=cat.name; document.getElementById('products').style.display='block'; renderProducts(id); }
  function renderProducts(catId){ const p=document.getElementById('products-container'); const filtered=MOCK_PRODUCTS.filter(x=>x.categoryId===catId); p.innerHTML = filtered.map(item=>`<div class="product-card"><h4>${item.country} - ${item.city}</h4><p>${item.description}</p><p class="product-price">R$ ${item.price.toFixed(2).replace('.',',')}</p><button class="btn btn-primary" onclick="openCheckoutModal(${item.id})">Comprar</button></div>`).join(''); if(filtered.length===0) p.innerHTML=`<p style="text-align:center;color:var(--text-secondary);grid-column:1 / -1;">Nenhum produto disponível nesta categoria no momento.</p>` }

  function renderColumns(){ const c=document.getElementById('columns-container'); if(!c) return; c.innerHTML = MOCK_COLUMNS.map(col=>`<div class="column-card" onclick="openColumnModal(${col.id})"><div><h4>${col.title}</h4><div class="column-preview">${col.content.substring(0,150)}...</div></div><div class="column-date">Publicado em ${col.date}</div></div>`).join(''); }
  function openColumnModal(id){ const col=MOCK_COLUMNS.find(c=>c.id===id); if(!col) return; document.getElementById('modal-column-title').textContent=col.title; document.getElementById('modal-column-date').textContent=`Publicado em ${col.date}`; document.getElementById('modal-column-content').textContent=col.content; document.getElementById('column-modal')?.style.display='block'; }

  // reviews
  function renderRatingStars(){ const container=document.getElementById('rating-stars'); if(!container) return; container.innerHTML=''; for(let i=1;i<=5;i++){ const star=document.createElement('i'); star.className=`fas fa-star star ${i<=selectedRating?'selected':''}`; star.dataset.value=i; star.onclick=()=>{ if(i===selectedRating) selectedRating=0; else selectedRating=i; renderRatingStars(); }; container.appendChild(star); } updateRatingLegend(); }
  function updateRatingLegend(){ const el=document.getElementById('rating-legend'); let text='Clique nas estrelas para nos avaliar'; if(selectedRating>=1 && selectedRating<=2) text='1 a 2 Estrela - Muito ruim'; else if(selectedRating===3) text='3 Estrela - Regular'; else if(selectedRating===4) text='4 Estrela - Bom'; else if(selectedRating===5) text='5 Estrela - Excelente'; if(el) el.textContent=text; }
  document.getElementById('submit-review-form')?.addEventListener('submit', (e)=>{ e.preventDefault(); const fb=document.getElementById('review-feedback'); if(selectedRating===0){ fb.textContent='Por favor, selecione uma nota de 1 a 5 estrelas.'; fb.className='feedback-message feedback-error'; fb.style.display='block'; return; } const form=e.target; const review={ rating:selectedRating, name:form.querySelector('#review-nome').value, lastName:form.querySelector('#review-sobrenome').value, email:form.querySelector('#review-email').value, gender:form.querySelector('#review-genero').value, birthDate:form.querySelector('#review-aniversario').value, state:form.querySelector('#review-estado').value, city:form.querySelector('#review-cidade').value, type:form.querySelector('#review-tipo').value, comment:form.querySelector('#review-comentario').value, date:new Date().toISOString() }; MOCK_REVIEWS.push(review); MOCK_STATS.reviews++; fb.textContent='Sua avaliação foi enviada com sucesso! Obrigado pelo seu feedback.'; fb.className='feedback-message feedback-success'; fb.style.display='block'; form.reset(); selectedRating=0; renderRatingStars(); setTimeout(()=>fb.style.display='none',3000); });

  // contact
  function initContact(){ const form=document.getElementById('contactForm'); form?.addEventListener('submit', async (e)=>{ e.preventDefault(); const fb=document.getElementById('contact-feedback'); const data={ name:form['from_name'].value, email:form['from_email'].value, subject:form['subject'].value, message:form['message'].value }; try{ const res=await fetch('/api/send-contact',{ method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify(data) }); const json=await res.json(); if(json.ok){ fb.textContent='Mensagem enviada com sucesso!'; fb.className='feedback-message feedback-success'; fb.style.display='block'; form.reset(); setTimeout(()=>fb.style.display='none',3000); } else { throw new Error(json.error||'send failed'); } }catch(err){ console.error(err); fb.textContent='Erro ao enviar mensagem.'; fb.className='feedback-message feedback-error'; fb.style.display='block'; } }); }

  // auth (mock)
  function initAuth(){ document.getElementById('open-auth-btn')?.addEventListener('click', ()=>document.getElementById('auth-modal').style.display='block'); document.getElementById('admin-login-btn')?.addEventListener('click', ()=>document.getElementById('admin-login-modal').style.display='block'); document.getElementById('login-form')?.addEventListener('submit', (e)=>{ e.preventDefault(); const form=e.target; const email=form.querySelector('#login-email').value; const pw=form.querySelector('#login-password').value; const user=MOCK_USERS.find(u=>u.email===email && u.password===pw); const fb=document.getElementById('login-feedback'); if(user){ CURRENT_USER=user; updateAuthDisplay(); document.getElementById('auth-modal').style.display='none'; showSection('user-profile'); renderUserProfile(); } else { fb.textContent='Email ou senha incorretos.'; fb.className='feedback-message feedback-error'; fb.style.display='block'; } }); document.getElementById('register-form')?.addEventListener('submit',(e)=>{ e.preventDefault(); const form=e.target; const pw=form.querySelector('#register-password').value; const pwc=form.querySelector('#register-confirm-password').value; const fb=document.getElementById('register-feedback'); if(pw!==pwc){ fb.textContent='As senhas não coincidem!'; fb.className='feedback-message feedback-error'; fb.style.display='block'; return; } const newUser={ id:(MOCK_USERS.length+1).toString(), profileName:form.querySelector('#register-profile-name').value, email:form.querySelector('#register-email').value, password:pw, firstName:form.querySelector('#register-nome').value, lastName:form.querySelector('#register-sobrenome').value, birthDate:form.querySelector('#register-nascimento').value, state:form.querySelector('#register-estado').value, city:form.querySelector('#register-cidade').value, bankName:'', bankNumber:'', purchases:[] }; MOCK_USERS.push(newUser); MOCK_STATS.profiles++; fb.textContent='Cadastro realizado com sucesso! Faça login para continuar.'; fb.className='feedback-message feedback-success'; fb.style.display='block'; form.reset(); setTimeout(()=>{ document.querySelector('#login-tab')?.classList.add('active'); document.querySelector('.tab-btn[data-tab="login"]')?.classList.add('active'); },1500); }); }

  function updateAuthDisplay(){ const authState=document.getElementById('auth-state'); const userDisplay=document.getElementById('user-display'); if(CURRENT_USER){ authState.style.display='none'; userDisplay.classList.add('logged-in'); document.getElementById('user-initial').textContent=CURRENT_USER.profileName.charAt(0).toUpperCase(); document.getElementById('user-welcome').textContent=`Olá, ${CURRENT_USER.profileName}!`; } else { authState.style.display='flex'; userDisplay.classList.remove('logged-in'); } }

  function renderUserProfile(){ if(!CURRENT_USER) return; document.getElementById('profile-content').style.display='block'; const view=document.getElementById('personal-data-view'); view.innerHTML=`<div class="data-item"><p>Nome:</p><strong>${CURRENT_USER.firstName} ${CURRENT_USER.lastName}</strong></div><div class="data-item"><p>Nome de Perfil:</p><strong>${CURRENT_USER.profileName}</strong></div><div class="data-item"><p>Email:</p><strong>${CURRENT_USER.email}</strong></div><div class="data-item"><p>Data de Nasc.:</p><strong>${CURRENT_USER.birthDate}</strong></div><div class="data-item"><p>Localização:</p><strong>${CURRENT_USER.city}, ${CURRENT_USER.state}</strong></div>`; const bankView=document.getElementById('bank-data-view'); if(CURRENT_USER.bankName){ bankView.innerHTML=`<div class="profile-data-grid"><div class="data-item"><p>Cartão Salvo:</p><strong>${CURRENT_USER.bankName}</strong></div><div class="data-item"><p>Número:</p><strong>${CURRENT_USER.bankNumber}</strong></div></div>`; } else { bankView.innerHTML=`<p style="color:var(--text-secondary);">Nenhum dado bancário salvo. Use o checkout seguro para salvar um método de pagamento.</p>`; } const purchased=document.getElementById('purchased-materials'); purchased.innerHTML = CURRENT_USER.purchases && CURRENT_USER.purchases.length>0 ? CURRENT_USER.purchases.map(p=>`<li><a href="${p.fileUrl}" target="_blank" rel="noreferrer">${p.title} (${p.code})</a><span>${p.date}</span></li>`).join('') : '<li>Nenhum material adquirido ainda.</li>'; }

  function logoutUser(){ CURRENT_USER=null; updateAuthDisplay(); showSection('hero'); document.getElementById('profile-content').style.display='none'; }

  // checkout (simple) - calls backend to create Stripe Checkout Session
  function openCheckoutModal(productId){ if(!CURRENT_USER){ alert('Você precisa estar logado para realizar uma compra.'); document.getElementById('auth-modal').style.display='block'; return; } const product=MOCK_PRODUCTS.find(p=>p.id===productId); if(!product) return; document.getElementById('checkout-modal')?.setAttribute('data-product-id',productId); document.getElementById('checkout-product-name').textContent=`${product.country} - ${product.city}`; document.getElementById('checkout-product-price').textContent=`R$ ${product.price.toFixed(2).replace('.',',')}`; document.getElementById('checkout-total-value').textContent=`R$ ${product.price.toFixed(2).replace('.',',')}`; document.getElementById('checkout-feedback').style.display='none'; document.getElementById('checkout-modal').style.display='block'; }

  async function processPayment(){ const pid=parseInt(document.getElementById('checkout-modal').getAttribute('data-product-id'),10); const product=MOCK_PRODUCTS.find(p=>p.id===pid); const feedback=document.getElementById('checkout-feedback'); if(!product||!CURRENT_USER){ feedback.textContent='Erro na compra.'; feedback.className='feedback-message feedback-error'; feedback.style.display='block'; return; } try{ const resp=await fetch('/api/create-checkout-session',{ method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({ productId:product.id, productTitle:product.description, price:Math.round(product.price*100), customerEmail:CURRENT_USER.email }) }); const data=await resp.json(); if(data.url) window.location.href=data.url; else throw new Error('Falha ao criar sessão'); }catch(err){ console.error(err); feedback.textContent='Erro ao iniciar pagamento.'; feedback.className='feedback-message feedback-error'; feedback.style.display='block'; } }

  // export helper omitted for brevity

  // inicializacao
  </script>
  <script>
  document.addEventListener('DOMContentLoaded', ()=>{ // bind checkout confirm
    document.getElementById('checkout-confirm-btn')?.addEventListener('click', processPayment);
  });
  </script>
</body>
</html>
