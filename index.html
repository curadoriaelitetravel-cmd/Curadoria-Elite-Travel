<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Curadoria Elite Travel - O seu mundo, perfeitamente indicado</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">

<style>
  :root{
    --gold:#D4AF37;
    --bg-dark:#0f0f0f;
    --card-dark:#161616;
    --text-light:#f3f1ee;
    --border-dark:#2b2b2b;
    --btn-hover:#E1C16E;
  }
  .light-theme{
    --bg-dark:#ffffff;
    --card-dark:#f7f7f7;
    --text-light:#222;
  }
  *{box-sizing:border-box;margin:0;padding:0}
  body{font-family:'Playfair Display',serif;background:var(--bg-dark);color:var(--text-light);line-height:1.5;transition:background .3s,color .3s}
  a{color:var(--gold)}
  .container{max-width:1200px;margin:0 auto;padding:0 20px}
  header{background:var(--card-dark);border-bottom:2px solid var(--border-dark);position:sticky;top:0;z-index:100}
  .header-inner{display:flex;align-items:center;justify-content:space-between;padding:14px 0}
  .brand{display:flex;align-items:center;gap:12px}
  .brand img{width:56px;height:56px;object-fit:contain}
  .brand h1{font-family:'Cinzel',serif;font-size:1.05rem;color:var(--text-light);margin:0;letter-spacing:0.6px}
  .brand small{display:block;color:var(--gold);font-size:0.8rem;margin-top:4px}
  nav ul{list-style:none;display:flex;gap:20px;align-items:center}
  nav a{color:var(--text-light);text-transform:uppercase;font-weight:700;font-size:0.85rem;text-decoration:none}
  .auth-buttons{display:flex;gap:10px;align-items:center}
  .btn{padding:8px 14px;border-radius:4px;border:2px solid var(--gold);background:var(--gold);color:#111;font-weight:700;cursor:pointer;font-family:'Cinzel',serif}
  .btn-outline{background:transparent;border:2px solid var(--gold);color:var(--gold)}
  .btn-small{padding:6px 10px;font-size:0.85rem}
  #hero{background-image:url('https://picsum.photos/1600/600?blur=2');background-size:cover;background-position:center;height:60vh;display:flex;align-items:center;justify-content:center;text-align:center;position:relative}
  #hero::before{content:"";position:absolute;inset:0;background:rgba(0,0,0,0.45)}
  .hero-content{position:relative;z-index:2;color:var(--text-light);max-width:900px;padding:40px}
  .hero-content h2{font-family:'Cinzel',serif;color:var(--gold);font-size:2.6rem;margin-bottom:10px}
  .hero-content p{font-size:1.05rem;color:var(--text-light);margin-bottom:18px}
  .social-icons{display:flex;gap:18px;justify-content:center;margin-bottom:18px}
  .social-icons a{font-size:1.9rem;color:var(--text-light);text-decoration:none}
  .social-icons a:hover{color:var(--gold)}
  section{padding:60px 0}
  h2.section-title{font-family:'Cinzel',serif;color:var(--gold);text-align:center;margin-bottom:16px}
  .who .who-text{max-width:900px;margin:0 auto;text-align:center;color:var(--text-light);font-size:1rem;margin-bottom:28px}
  .cards{display:grid;grid-template-columns:repeat(3,1fr);gap:20px;max-width:1100px;margin:0 auto}
  .card{background:var(--card-dark);padding:26px;border-radius:8px;border:1px solid var(--border-dark);box-shadow:0 4px 12px rgba(0,0,0,0.5);cursor:pointer;transition:transform .2s}
  .card:hover{transform:translateY(-6px);border-color:var(--gold)}
  .card h3{color:var(--gold);margin-bottom:10px;font-size:1.05rem}
  .card p{color:var(--text-light);font-size:0.95rem}
  .modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.7);backdrop-filter:blur(4px);z-index:300;align-items:center;justify-content:center}
  .modal.active{display:flex}
  .modal-box{background:var(--card-dark);padding:22px;border-radius:8px;border:1px solid var(--gold);width:90%;max-width:560px;position:relative}
  .close-x{position:absolute;right:12px;top:8px;font-size:22px;color:var(--text-light);cursor:pointer}
  .modal-box h3{color:var(--gold);margin-bottom:10px}
  .modal-box p{color:var(--text-light)}
  .categories-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:14px;margin-top:18px}
  .products-container{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:18px;margin-top:22px}
  .rating-section{max-width:800px;margin:0 auto;text-align:center;padding:18px;border:1px solid var(--border-dark);border-radius:8px;background:transparent}
  .stars .fa-star{font-size:28px;color:var(--text-light);margin:0 6px;cursor:pointer}
  .stars .selected{color:#FFC107}
  .card.contact{max-width:700px;margin:0 auto;padding:22px}
  .profile-section{max-width:900px;margin:0 auto}
  footer.site-footer{background:var(--card-dark);color:var(--text-light);padding:18px 0;border-top:2px solid var(--gold)}
  .footer-content{display:flex;justify-content:space-between;gap:20px;align-items:flex-start;flex-wrap:wrap}
  .footer-left{flex:1 1 45%}
  .footer-right{flex:1 1 45%;text-align:right}
  .footer-bottom{text-align:center;padding-top:12px;border-top:1px solid var(--border-dark);color:var(--text-light);font-size:0.85rem}
  .contact-item{display:flex;gap:8px;align-items:center;justify-content:flex-end;color:var(--text-light)}
  .theme-toggle-footer{background:none;border:none;font-size:30px;color:var(--gold);cursor:pointer;display:block;margin:0 auto}
  @media (max-width:768px){
    .footer-content{flex-direction:column;align-items:center;text-align:center}
    .footer-right{order:2;text-align:center}
    .footer-left{order:1}
  }
  @media (max-width:1024px){ .cards{grid-template-columns:repeat(2,1fr)} }
  @media (max-width:640px){
    nav ul{display:none}
    .brand h1{font-size:1rem}
    #hero{height:50vh}
    .cards{grid-template-columns:1fr}
    .hero-content h2{font-size:1.8rem}
    .hero-content p{font-size:0.95rem}
    .footer-right{text-align:center}
    .brand img{width:48px;height:48px}
  }
  .muted{color:var(--text-light);opacity:0.85}
  .center{text-align:center}
  /* Mobile bottom nav (Option B minimalista) */
  .bottom-nav{
    display:none;
    position:fixed;
    left:0;right:0;bottom:0;
    background:var(--card-dark);
    border-top:1px solid var(--border-dark);
    display:flex;justify-content:space-around;align-items:center;padding:8px 6px;z-index:200;
  }
  .bottom-nav a{color:var(--text-light);text-decoration:none;font-size:0.9rem;display:flex;flex-direction:column;align-items:center;gap:6px}
  .bottom-nav .icon{font-size:18px;color:var(--gold)}
  @media(max-width:640px){
    .bottom-nav{display:flex}
    body{padding-bottom:68px} /* espaço para a barra */
  }

  /* slide-in menu (menu completo) */
  .slide-menu{
    position:fixed;top:0;left:-320px;bottom:0;width:320px;background:var(--card-dark);z-index:500;transition:left .28s;box-shadow:5px 0 18px rgba(0,0,0,0.6);padding:18px;
  }
  .slide-menu.open{left:0}
  .slide-menu .close-slide{position:absolute;right:12px;top:12px;color:var(--text-light);font-size:20px;cursor:pointer}
  .slide-menu .menu-list{margin-top:40px;display:flex;flex-direction:column;gap:14px}
  .slide-menu a{color:var(--text-light);text-decoration:none;padding:10px;border-radius:6px;font-weight:700}
  .slide-menu .menu-footer{position:absolute;bottom:20px;left:18px;right:18px;text-align:center}
</style>
</head>
<body>

<header>
  <div class="container">
    <div class="header-inner">
      <div class="brand">
        <!-- Rosa dos Ventos ao lado do nome -->
        <img src="https://cdn.jsdelivr.net/gh/curadoriaelitetravel-cmd/Curadoria-Elite-Travel@main/assets/compass.png" alt="Rosa dos Ventos Curadoria Elite Travel" />
        <div>
          <h1>CURADORIA ELITE TRAVEL</h1>
          <small>O seu mundo, perfeitamente indicado.</small>
        </div>
      </div>

      <nav>
        <ul>
          <li><a href="#hero" onclick="showSection('hero')">Início</a></li>
          <li><a href="#who" onclick="showSection('who')">Quem somos</a></li>
          <li><a href="#categories" onclick="showSection('categories')">Curadoria</a></li>
          <li><a href="#columns" onclick="showSection('columns')">Colunas</a></li>
          <li><a href="#review" onclick="showSection('review')">Avalie-nos</a></li>
          <li><a href="#contact" onclick="showSection('contact')">Contato</a></li>
        </ul>
      </nav>

      <div class="auth-buttons">
        <button class="btn btn-small btn-outline" onclick="openAuthModal()">Entrar / Cadastrar</button>
        <button class="btn btn-small" onclick="openSlideMenu()" title="Abrir menu">☰</button>
      </div>
    </div>
  </div>
</header>

<!-- slide-in lateral -->
<div id="slideMenu" class="slide-menu" aria-hidden="true">
  <span class="close-slide" onclick="closeSlideMenu()">&times;</span>
  <div class="menu-list">
    <a href="#hero" onclick="navigateFromMenu('hero')">Início</a>
    <a href="#who" onclick="navigateFromMenu('who')">Quem somos</a>
    <a href="#categories" onclick="navigateFromMenu('categories')">Curadoria</a>
    <a href="#columns" onclick="navigateFromMenu('columns')">Colunas</a>
    <a href="#review" onclick="navigateFromMenu('review')">Avalie-nos</a>
    <a href="#contact" onclick="navigateFromMenu('contact')">Contato</a>
  </div>
  <div class="menu-footer">
    <button class="btn btn-outline btn-small" onclick="toggleTheme()">Alternar Tema</button>
  </div>
</div>

<section id="hero">
  <div class="hero-content container">
    <h2>Curadoria Elite Travel</h2>
    <p>Curadoria exclusiva para as experiências de viagem mais inesquecíveis.</p>

    <div class="social-icons">
      <a href="https://www.instagram.com/curadoriaelitetravel/" target="_blank" rel="noopener noreferrer"><i class="fab fa-instagram"></i></a>
      <a href="https://www.linkedin.com/company/curadoria-elite-travel" target="_blank" rel="noopener noreferrer"><i class="fab fa-linkedin"></i></a>
    </div>

    <button class="btn" onclick="showSection('categories')">Descubra nossas Curadorias</button>
  </div>
</section>

<section id="who">
  <div class="container">
    <h2 class="section-title">Quem Somos</h2>
    <p class="who-text">Na Curadoria Elite Travel, acreditamos que seu tempo é seu bem mais valioso. Percebemos que, em um mundo onde a praticidade digital é essencial, o viajante moderno buscava autonomia sem abrir mão de inspiração e confiança – uma assistência ágil e personalizada que ainda não existia. Foi dessa necessidade que nascemos: somos a resposta para quem deseja explorar o mundo de forma inteligente, com curadorias que transformam destinos em universos referenciados e acessíveis digitalmente. Abraçamos essa missão com excelência, oferecendo narrativas turísticas sob medida para que sua próxima aventura seja não apenas planejada, mas vivida intensamente, mesmo antes de partir. O seu mundo, bem indicado.</p>

    <div class="cards" role="list">
      <div class="card" onclick="openModal('vision-modal')">
        <h3>VISÃO</h3>
        <p>Ser a principal referência digital para quem busca apoio, inspiração e orientação em viagens, oferecendo uma curadoria de alto nível que torna a descoberta de destinos mais clara, elegante e acessível — um ponto de partida confiável para explorar o mundo com profundidade e propósito.</p>
      </div>

      <div class="card" onclick="openModal('mission-modal')">
        <h3>MISSÃO</h3>
        <p>Oferecer materiais de apoio que iluminam a escolha dos melhores lugares, reunindo conteúdo de qualidade, excelência na seleção e uma visão equilibrada entre experiência e valor.</p>
      </div>

      <div class="card" onclick="openModal('niche-modal')">
        <h3>NICHO</h3>
        <p>Viajantes que buscam experiências entre 3 e 4 estrelas, desejando conhecer os principais destinos de forma acolhedora, inteligente e cuidadosamente selecionada.</p>
      </div>
    </div>
  </div>
</section>

<section id="categories">
  <div class="container">
    <h2 class="section-title">Categorias de Curadoria</h2>
    <div class="categories-grid" id="category-cards-container"></div>

    <div id="products" style="margin-top:22px">
      <h3 id="current-category-title" class="center muted"></h3>
      <div class="products-container" id="products-container"></div>
    </div>
  </div>
</section>

<section id="columns">
  <div class="container">
    <h2 class="section-title">Colunas Diárias</h2>
    <div class="columns-container" id="columns-container"></div>
  </div>
</section>

<section id="review">
  <div class="container">
    <h2 class="section-title">Sua percepção nos ajuda a evoluir</h2>
    <div class="rating-section">
      <div class="stars" id="rating-stars"></div>
      <div id="rating-legend" class="muted" style="margin-top:8px"></div>
    </div>

    <form id="submit-review-form" onsubmit="submitReview(event)" style="max-width:900px;margin:20px auto">
      <div style="display:flex;gap:12px;flex-wrap:wrap">
        <input type="text" id="review-nome" placeholder="Nome" required style="flex:1;padding:10px;border-radius:6px;border:1px solid var(--border-dark);background:transparent;color:var(--text-light)">
        <input type="text" id="review-sobrenome" placeholder="Sobrenome" required style="flex:1;padding:10px;border-radius:6px;border:1px solid var(--border-dark);background:transparent;color:var(--text-light)">
      </div>
      <div style="margin-top:10px;display:flex;gap:12px;flex-wrap:wrap">
        <input type="email" id="review-email" placeholder="Email" required style="flex:1;padding:10px;border-radius:6px;border:1px solid var(--border-dark);background:transparent;color:var(--text-light)">
        <input type="text" id="review-genero" placeholder="Gênero" required style="flex:1;padding:10px;border-radius:6px;border:1px solid var(--border-dark);background:transparent;color:var(--text-light)">
      </div>
      <div style="margin-top:10px">
        <textarea id="review-comentario" placeholder="Comentário (máx. 200 chars)" maxlength="200" rows="4" style="width:100%;padding:10px;border-radius:6px;border:1px solid var(--border-dark);background:transparent;color:var(--text-light)"></textarea>
      </div>
      <div id="review-feedback" style="display:none;margin-top:10px"></div>
      <button class="btn" type="submit" style="margin-top:12px">Enviar Avaliação</button>
    </form>
  </div>
</section>

<section id="contact">
  <div class="container">
    <h2 class="section-title">Fale Conosco</h2>
    <div class="card contact">
      <form id="contactForm" onsubmit="sendContactEmail(event)">
        <div style="display:flex;gap:12px;flex-wrap:wrap">
          <input type="text" id="contact-name" name="from_name" placeholder="Nome" required style="flex:1;padding:10px;border-radius:6px;border:1px solid var(--border-dark);background:transparent;color:var(--text-light)">
          <input type="email" id="contact-email" name="from_email" placeholder="Email" required style="flex:1;padding:10px;border-radius:6px;border:1px solid var(--border-dark);background:transparent;color:var(--text-light)">
        </div>
        <div style="margin-top:10px">
          <input type="text" id="contact-subject" name="subject" placeholder="Assunto" required style="width:100%;padding:10px;border-radius:6px;border:1px solid var(--border-dark);background:transparent;color:var(--text-light)">
        </div>
        <div style="margin-top:10px">
          <textarea id="contact-message" name="message" placeholder="Mensagem (máx. 300 chars)" maxlength="300" rows="5" style="width:100%;padding:10px;border-radius:6px;border:1px solid var(--border-dark);background:transparent;color:var(--text-light)"></textarea>
        </div>
        <div id="contact-feedback" style="display:none;margin-top:10px"></div>
        <button class="btn" type="submit" style="margin-top:12px">Enviar Mensagem</button>
      </form>
    </div>
  </div>
</section>

<footer class="site-footer">
  <div class="container footer-content">
    <div class="footer-left">
      <h3 style="color:var(--gold)">Curadoria Elite Travel</h3>
      <p class="muted">O seu mundo, perfeitamente indicado. Oferecemos soluções de viagem com curadoria especializada, transformando seus destinos em experiências inesquecíveis.</p>
    </div>

    <div class="footer-right">
      <div class="contact-item">
        <div style="display:flex;gap:12px;align-items:center;justify-content:center">
          <div style="margin-right:12px">curadoriaelitetravel@gmail.com <i class="fas fa-envelope" style="color:var(--gold);margin-left:8px"></i></div>
          <div>São Paulo, SP <i class="fas fa-map-marker-alt" style="color:var(--gold);margin-left:8px"></i></div>
        </div>
      </div>

      <button class="theme-toggle-footer" id="theme-toggle-footer" title="Alternar tema" onclick="toggleTheme()">
        <i id="theme-icon-footer" class="fas fa-moon"></i>
      </button>
    </div>
  </div>

  <div class="container footer-bottom">
    <p>© 2025 Curadoria Elite Travel. Todos os direitos reservados.</p>
  </div>
</footer>

<!-- Modals Visao / Missao / Nicho -->
<div id="vision-modal" class="modal" aria-hidden="true">
  <div class="modal-box">
    <span class="close-x" onclick="closeModal('vision-modal')">&times;</span>
    <h3>VISÃO</h3>
    <p>Ser a principal referência digital para quem busca apoio, inspiração e orientação em viagens, oferecendo uma curadoria de alto nível que torna a descoberta de destinos mais clara, elegante e acessível — um ponto de partida confiável para explorar o mundo com profundidade e propósito.</p>
  </div>
</div>

<div id="mission-modal" class="modal" aria-hidden="true">
  <div class="modal-box">
    <span class="close-x" onclick="closeModal('mission-modal')">&times;</span>
    <h3>MISSÃO</h3>
    <p>Oferecer materiais de apoio que iluminam a escolha dos melhores lugares, reunindo conteúdo de qualidade, excelência na seleção e uma visão equilibrada entre experiência e valor.</p>
  </div>
</div>

<div id="niche-modal" class="modal" aria-hidden="true">
  <div class="modal-box">
    <span class="close-x" onclick="closeModal('niche-modal')">&times;</span>
    <h3>NICHO</h3>
    <p>Viajantes que buscam experiências entre 3 e 4 estrelas, desejando conhecer os principais destinos de forma acolhedora, inteligente e cuidadosamente selecionada.</p>
  </div>
</div>

<!-- bottom nav (mobile minimalista - opção B) -->
<nav class="bottom-nav" aria-hidden="false">
  <a href="#hero" onclick="showSection('hero')"><i class="fas fa-home icon"></i><span>Início</span></a>
  <a href="#categories" onclick="showSection('categories')"><i class="fas fa-th-list icon"></i><span>Curadoria</span></a>
  <a href="#columns" onclick="showSection('columns')"><i class="fas fa-newspaper icon"></i><span>Colunas</span></a>
  <a href="#profile" onclick="showSection('profile')"><i class="fas fa-user icon"></i><span>Perfil</span></a>
</nav>

<!-- SCRIPTS -->
<script type="module">
import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';

// Supabase config (public/anon key you provided)
const SUPABASE_URL = 'https://lnyoqoezezisakghtmim.supabase.co';
const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxueW9xb2V6ZXppc2FrZ2h0bWltIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQxNjI4OTMsImV4cCI6MjA3OTczODg5M30.Nn9ZPRXeJlvCGJ2kXQ3XBvT743pQn2VIXEsT9pexqnA';
const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);

/* Helper SPA */
function showSection(id){
  document.querySelectorAll('section').forEach(s=>s.style.display='none');
  const el = document.getElementById(id);
  if(el) el.style.display='block';
  window.scrollTo({top:0,behavior:'smooth'});
}

/* Theme toggle */
function toggleTheme(){
  document.body.classList.toggle('light-theme');
  const icon = document.getElementById('theme-icon-footer');
  icon.className = document.body.classList.contains('light-theme') ? 'fas fa-sun' : 'fas fa-moon';
  localStorage.setItem('theme', document.body.classList.contains('light-theme') ? 'light' : 'dark');
}
window.toggleTheme = toggleTheme;
if(localStorage.getItem('theme')==='light'){ document.body.classList.add('light-theme'); document.getElementById('theme-icon-footer').className='fas fa-sun' }

/* Slide menu functions */
function openSlideMenu(){ document.getElementById('slideMenu').classList.add('open'); }
function closeSlideMenu(){ document.getElementById('slideMenu').classList.remove('open'); }
function navigateFromMenu(section){ closeSlideMenu(); showSection(section); }
window.openSlideMenu = openSlideMenu; window.closeSlideMenu = closeSlideMenu; window.navigateFromMenu = navigateFromMenu;

/* Modals */
function openModal(id){ document.getElementById(id).classList.add('active') }
function closeModal(id){ document.getElementById(id).classList.remove('active') }
window.openModal = openModal; window.closeModal = closeModal;

/* Auth (simple prompts for demo) */
async function openAuthModal(){
  const action = prompt('Digite "login" para entrar ou "register" para criar conta:');
  if(action==='register') {
    const fullName = prompt('Nome completo:');
    const profileName = prompt('Nome de perfil (ex: Cliente123):');
    const email = prompt('Email:');
    const password = prompt('Senha (mín 6 caracteres):');
    if(!email || !password) return alert('Email e senha são obrigatórios.');
    const { data, error } = await supabase.auth.signUp({ email, password }, { data: { full_name: fullName, profile_name: profileName }});
    if(error) { console.error(error); alert('Erro no cadastro: ' + error.message); return; }
    alert('Cadastro realizado. Verifique seu email para confirmação (se habilitado). Faça login após confirmar.');
  } else if(action==='login') {
    const email = prompt('Email:');
    const password = prompt('Senha:');
    const { data, error } = await supabase.auth.signInWithPassword({ email, password });
    if(error) { console.error(error); alert('Erro no login: ' + error.message); return; }
    alert('Login efetuado com sucesso!');
    await loadUserProfile();
    showSection('who');
  } else {
    return;
  }
}
window.openAuthModal = openAuthModal;

/* Logout */
async function logoutUser(){
  await supabase.auth.signOut();
  renderAuthDisplay();
  alert('Você saiu da sua conta.');
}
window.logoutUser = logoutUser;

/* Render auth display */
async function renderAuthDisplay(){
  const { data: sessionData } = await supabase.auth.getSession();
  const session = sessionData?.session || null;
  const user = session ? session.user : null;
  const authButtons = document.querySelector('.auth-buttons');
  if(user){
    authButtons.innerHTML = `
      <div style="display:flex;align-items:center;gap:10px">
        <div style="background:var(--gold);color:#111;padding:6px 10px;border-radius:50%;font-weight:700">${(user.user_metadata?.profile_name||user.email||'U').charAt(0).toUpperCase()}</div>
        <div style="color:var(--text-light);font-weight:700">${user.user_metadata?.profile_name || user.email}</div>
        <button class="logout-btn" style="background:none;border:none;color:var(--gold);cursor:pointer" onclick="logoutUser()">Sair</button>
      </div>
    `;
  } else {
    authButtons.innerHTML = `<button class="btn btn-small btn-outline" onclick="openAuthModal()">Entrar / Cadastrar</button><button class="btn btn-small" onclick="openSlideMenu()">☰</button>`;
  }
}
renderAuthDisplay();

/* Detect auth changes */
supabase.auth.onAuthStateChange((event, session) => {
  renderAuthDisplay();
  if(event === 'SIGNED_IN') loadUserProfile();
});

/* load user profile (simple) */
async function loadUserProfile(){
  const { data: { session } } = await supabase.auth.getSession();
  if(!session) return;
  const user = session.user;
  console.log('User signed in', user);
}

/* contact form send to serverless API */
async function sendContactEmail(e){
  e.preventDefault();
  const f = document.getElementById('contactForm');
  const feedback = document.getElementById('contact-feedback');
  const payload = {
    name: f['from_name'].value,
    email: f['from_email'].value,
    subject: f['subject'].value,
    message: f['message'].value
  };
  try{
    const res = await fetch('/api/send-contact',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});
    const json = await res.json();
    if(json.ok){ feedback.style.display='block'; feedback.style.color='green'; feedback.textContent='Mensagem enviada com sucesso!'; f.reset(); setTimeout(()=>feedback.style.display='none',3000); }
    else { feedback.style.display='block'; feedback.style.color='crimson'; feedback.textContent = json.error || 'Erro ao enviar'; }
  }catch(err){
    feedback.style.display='block'; feedback.style.color='crimson'; feedback.textContent='Erro ao enviar mensagem';
    console.error(err);
  }
}

/* reviews */
let selectedRating = 0;
function renderRatingStars(){
  const container = document.getElementById('rating-stars');
  container.innerHTML='';
  for(let i=1;i<=5;i++){
    const el = document.createElement('i');
    el.className = 'fas fa-star' + (i<=selectedRating ? ' selected' : '');
    el.dataset.value = i;
    el.onclick = ()=>{ selectedRating = (selectedRating===i?0:i); renderRatingStars(); updateRatingLegend(); };
    container.appendChild(el);
  }
  updateRatingLegend();
}
function updateRatingLegend(){
  const el = document.getElementById('rating-legend');
  let txt='Clique nas estrelas para nos avaliar';
  if(selectedRating===1||selectedRating===2) txt='1-2 Estrelas — Insatisfatório';
  if(selectedRating===3) txt='3 Estrelas — Regular';
  if(selectedRating===4) txt='4 Estrelas — Bom';
  if(selectedRating===5) txt='5 Estrelas — Excelente';
  el.textContent = txt;
}
function submitReview(e){
  e.preventDefault();
  const f = e.target;
  const fb = document.getElementById('review-feedback');
  if(selectedRating===0){ fb.style.display='block'; fb.style.color='crimson'; fb.textContent='Selecione uma nota'; return; }
  fb.style.display='block'; fb.style.color='green'; fb.textContent='Avaliação enviada. Obrigado!';
  f.reset(); selectedRating=0; renderRatingStars();
  setTimeout(()=>fb.style.display='none',2500);
}

/* Mock data init for demo (remove when connected to DB) */
function initMock(){
  window.MOCK_CATEGORIES = [
    { id:1,name:'City Guide',icon:'map',price:49.90,description:'Roteiros completos de cidade.',status:'enabled' },
    { id:2,name:'Restaurante',icon:'restaurant',price:29.90,description:'Seleção dos melhores lugares.' },
    { id:3,name:'Hoteis',icon:'hotel',price:59.90,description:'Seleção de hospedagens de luxo.' }
  ];
  window.MOCK_PRODUCTS = [
    { id:101,code:'CG-PAR-24',categoryId:1,country:'França',city:'Paris',price:49.90,description:'Guia de Paris 3 dias',fileUrl:'mock_pdf_paris.pdf' },
    { id:102,code:'RT-NY-24',categoryId:2,country:'EUA',city:'Nova York',price:29.90,description:'Roteiro Gastronômico de Manhattan',fileUrl:'mock_pdf_ny_rest.pdf' }
  ];
  window.MOCK_COLUMNS = [
    { id:1,title:'O Despertar de Lisboa',date:'15/11/2025',content:'Pequena amostra da coluna...' }
  ];
  renderCategoryCards();
  renderColumns();
}

/* render categories/products */
function renderCategoryCards(){
  const c = document.getElementById('category-cards-container');
  if(!window.MOCK_CATEGORIES) return;
  c.innerHTML = window.MOCK_CATEGORIES.map(cat=>`
    <div class="category-card">
      <div style="font-size:28px;color:var(--gold)"><i class="material-symbols-outlined">${cat.icon}</i></div>
      <h4 style="color:var(--gold);margin:8px 0">${cat.name}</h4>
      <p class="muted" style="font-size:0.95rem">${cat.description}</p>
      <div style="margin-top:12px">
        <button class="btn btn-small" onclick="selectCategory(${cat.id})">Ver Curadorias</button>
      </div>
    </div>`).join('');
}
function selectCategory(id){
  const cat = window.MOCK_CATEGORIES.find(x=>x.id===id); if(!cat) return;
  document.getElementById('current-category-title').textContent = cat.name;
  document.getElementById('products').style.display='block';
  renderProducts(id);
}
function renderProducts(categoryId){
  const container = document.getElementById('products-container');
  const list = window.MOCK_PRODUCTS.filter(p=>p.categoryId===categoryId);
  container.innerHTML = list.length ? list.map(p=>`
    <div class="product-card card">
      <h4 style="color:var(--text-light)">${p.country} - ${p.city}</h4>
      <p class="muted">${p.description}</p>
      <div style="font-size:1.2rem;color:var(--gold);font-weight:700;margin:12px 0">R$ ${p.price.toFixed(2).replace('.',',')}</div>
      <button class="btn" onclick="openCheckout(${p.id})">Comprar</button>
    </div>`).join('') : '<p class="muted center">Nenhum produto disponível.</p>';
}

/* open checkout - calls serverless API */
async function openCheckout(productId){
  const prod = window.MOCK_PRODUCTS.find(p=>p.id===productId);
  if(!prod) return alert('Produto não encontrado');
  try{
    const resp = await fetch('/api/create-checkout-session',{
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({
        productId: prod.id,
        productTitle: prod.description,
        price: Math.round(prod.price * 100),
        quantity: 1,
        customerEmail: '' // opcional
      })
    });
    const data = await resp.json();
    if(data.url) window.location.href = data.url;
    else { console.error(data); alert('Erro criando sessão de pagamento'); }
  }catch(err){ console.error(err); alert('Erro ao comunicar com o servidor'); }
}

/* columns */
function renderColumns(){
  const c = document.getElementById('columns-container');
  if(!window.MOCK_COLUMNS) return;
  c.innerHTML = window.MOCK_COLUMNS.map(col=>`
    <div class="column-card card" onclick="openColumnModal(${col.id})">
      <h4 style="color:var(--text-light)">${col.title}</h4>
      <div class="muted" style="margin-top:10px">${col.content.substring(0,120)}...</div>
      <div style="margin-top:14px;color:var(--gold);font-size:0.9rem">Publicado em ${col.date}</div>
    </div>`).join('');
}
function openColumnModal(id){
  const col = (window.MOCK_COLUMNS||[]).find(x=>x.id===id); if(!col) return;
  const html = `<div class="modal-box"><span class="close-x" onclick="this.closest('.modal').classList.remove('active')">&times;</span><h3 style="color:var(--gold)">${col.title}</h3><p style="color:var(--text-light)">${col.content}</p></div>`;
  const wrapper = document.createElement('div'); wrapper.className='modal active'; wrapper.innerHTML = html;
  document.body.appendChild(wrapper);
}

document.addEventListener('DOMContentLoaded',()=>{
  document.querySelectorAll('section').forEach(s=>s.style.display='none');
  document.getElementById('hero').style.display='flex';
  renderRatingStars();
  initMock();
});
</script>
</body>
</html>
